
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Capstone-Project-20.1.Initial.Report.Version0.4.11.01.2022}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

Capstone Project 20.1: Initial Report and Exploratory Data Analysis
(EDA)

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

Project Name: Classification of Border Gateway Protocol Anomalies using
Machine Learning

\begin{center}\rule{0.5\linewidth}{\linethickness}\end{center}

Shaji R. Nathan

IP Infusion Inc.

Santa Clara, California

shaji.nathan@ipinfusion.com

    \textbf{Overview}: In this practical application, my goal is to compare
the performance of the machine learning based classifiers namely K
Nearest Neighbor, Logistic Regression, Decision Trees, and Support
Vector Machines in detecting protocol anomalies in Border Gateway
Routing Protocol. I will utilize Border Gateway Protocol (BGP) datasets
with routing records collected from Reseaux IP Europeens (RIPE) and
BCNET to implement an anomaly detection model. For the supervised
learning datasets from five well-known anomalies are used. They are
namely WannaCrypt, Moscow blackout, Slammer, Nimda, Code Red I, that
occurred in May 2017, May 2005, January 2003, September 2001, and July
2001. The datasets were made publicly available by Reseaux IP Europeens
(RIPE) Network Coordination Centre
(NCC):\textbf{\href{http://www.ensc.sfu.ca/~ljilja/cnl/projects/BGP_datasets/BGP_RIPE_datasets_for_anomaly_detection_csv_revised_19022021.zip}{RIPE}}.
The regular data is collected from IP Infusion's BGP gateways. Live BGP
updates are also available from the Center for Applied Internet Data
Analysis at UC San Diego.
\textbf{\href{https://bgpstream.caida.org/data}{CAIDA}}. In this project
we are looking to classify BGP updates on the provider edge routers in a
typical 4G/5G backhaul network. A typical backhaul network will look
like the one shown below. The end goal is to use a route reflector in
conjunction with the classifier to analyze the BGP updates from the
gateways and push a packet filter rule to block anomalous BGP traffic
whenever the classifier detects an anomalous BGP update.

    \begin{quote}
The basic idea is to develop a classifier that takes in BGP update
announcements and classifies it with a positive label (in case it's an
``anomaly'') assigns the numeric value of +1 (one), and a negative label
(``for normal updates '') assigns the numeric value of -1 (minus one).
The classifier is called by a BGP route reflector which pushes a route
filter to the cell site gateway based on the administrators network
policy when it gets a anomaly detected message from the classifier.
\end{quote}

    \#\#\# Step 1: Processing and Understanding the Data

\begin{quote}
BGP update messages from the network are collected in multi-threaded
routing toolkit (MRT) format. Then a protocol parser is used to extract
the BGP updated messages in ASCII. BGP features are extracted using an
open source C\# based tool (from CAIDA.org) to generate the datasets
(csv files). Labels for anomalies are added based on the periods when
data were collected. We are primarily interested in the 37 features from
the BGP update messages. In a BGP packet trace from a sniffer tool, the
BGP update message will look like so:
\end{quote}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np} 
          \PY{k+kn}{import} \PY{n+nn}{time}
          \PY{k+kn}{import} \PY{n+nn}{missingno} \PY{k}{as} \PY{n+nn}{msno}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}103}]:} \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
          \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
          \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{} matplotlib and seaborn setting}
        \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.dpi}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{150}
        \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{axes.spines.top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{k+kc}{False}
        \PY{n}{plt}\PY{o}{.}\PY{n}{rcParams}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{axes.spines.right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{k+kc}{False}
        
        \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{rc}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{figure.figsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}\PY{p}{\PYZcb{}}\PY{p}{)}
        \PY{n}{sns}\PY{o}{.}\PY{n}{set\PYZus{}theme}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{darkgrid}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} sns.set(font\PYZus{}scale=0.7)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k}{import} \PY{n}{KNeighborsClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{accuracy\PYZus{}score}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{,} \PY{n}{confusion\PYZus{}matrix}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GridSearchCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegression}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{metrics}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k}{import} \PY{n}{SVC}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{ExtraTreesClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k}{import} \PY{n}{make\PYZus{}classification}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{cross\PYZus{}val\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{inspection} \PY{k}{import} \PY{n}{permutation\PYZus{}importance}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{MinMaxScaler}\PY{p}{,} \PY{n}{StandardScaler}
        \PY{k+kn}{from} \PY{n+nn}{imblearn}\PY{n+nn}{.}\PY{n+nn}{over\PYZus{}sampling} \PY{k}{import} \PY{n}{SMOTE}
        \PY{k+kn}{from} \PY{n+nn}{imblearn}\PY{n+nn}{.}\PY{n+nn}{under\PYZus{}sampling} \PY{k}{import} \PY{n}{RandomUnderSampler}
        \PY{k+kn}{from} \PY{n+nn}{imblearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{Pipeline}
        \PY{k+kn}{from} \PY{n+nn}{imblearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{make\PYZus{}pipeline}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{MinMaxScaler}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegression}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k}{import} \PY{n}{KNeighborsClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{tree}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k}{import} \PY{n}{SVC}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{KFold}\PY{p}{,} \PY{n}{cross\PYZus{}val\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}\PY{p}{,} \PY{n}{ConfusionMatrixDisplay}\PY{p}{,} \PY{n}{classification\PYZus{}report}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{accuracy\PYZus{}score}\PY{p}{,} \PY{n}{precision\PYZus{}score}\PY{p}{,} \PY{n}{recall\PYZus{}score}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{,} \PY{n}{log\PYZus{}loss}\PY{p}{,} \PY{n}{fbeta\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{auc}\PY{p}{,} \PY{n}{roc\PYZus{}curve}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{,} \PY{n}{precision\PYZus{}recall\PYZus{}curve}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{svm}\PY{p}{,} \PY{n}{metrics}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GridSearchCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{confusion\PYZus{}matrix}\PY{p}{,} \PY{n}{accuracy\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{classification\PYZus{}report}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{Pipeline}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{compose} \PY{k}{import} \PY{n}{make\PYZus{}column\PYZus{}transformer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{experimental} \PY{k}{import} \PY{n}{enable\PYZus{}halving\PYZus{}search\PYZus{}cv} \PY{c+c1}{\PYZsh{} noqa}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{HalvingGridSearchCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{HalvingRandomSearchCV}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{set\PYZus{}config}
        \PY{n}{set\PYZus{}config}\PY{p}{(}\PY{n}{display}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{diagram}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{k+kn}{import} \PY{n+nn}{warnings}
        \PY{n}{warnings}\PY{o}{.}\PY{n}{filterwarnings}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \subsection{Step 2: Read in the Data}\label{step-2-read-in-the-data}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{code\PYZus{}redi\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dataset/Code\PYZus{}Red\PYZus{}I.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{slammer\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dataset/Slammer.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{nimda\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dataset/Nimda.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{nimda\PYZus{}df}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:} (10048, 42)
\end{Verbatim}
            
    \subsubsection{Combining the dataset}\label{combining-the-dataset}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{slammer\PYZus{}df}\PY{p}{,}\PY{n}{nimda\PYZus{}df}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{bgpdf}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{slammer\PYZus{}df}\PY{p}{,}\PY{n}{nimda\PYZus{}df}\PY{p}{,}\PY{n}{code\PYZus{}redi\PYZus{}df}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{df}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:} (17247, 42)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{bgpdf}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}14}]:} (24446, 42)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{T}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:}                                                        0      1      2      3  \textbackslash{}
         Hour and Minutes                                     1.0    2.0    3.0    4.0   
         Hour                                                 0.0    0.0    0.0    0.0   
         Minutes                                              1.0    2.0    3.0    4.0   
         Seconds                                              4.0    0.0   12.0    9.0   
         Number of announcements                             40.0   59.0   52.0   49.0   
         Number of withdrawals                                4.0    7.0    4.0    2.0   
         Number of announced NLRI prefixes                  161.0  133.0  138.0  119.0   
         Number of withdrawn NLRI prefixes                   28.0   69.0   32.0   24.0   
         Average AS-path length                               6.0    6.0    5.0    6.0   
         Maximum AS-path length                               8.0   13.0    7.0    9.0   
         Average unique AS-path length                        6.0    6.0    6.0    6.0   
         Number of duplicate announcements                   27.0    2.0   12.0    1.0   
         Number of duplicate withdrawals                     96.0  103.0  105.0   63.0   
         Number of implicit withdrawals                       0.0   11.0    0.0    0.0   
         Average edit distance                                8.0   13.0    7.0    9.0   
         Maximum edit distance                                0.7    1.1    0.9    0.8   
         Inter-arrival time                                   5.0    6.0    5.0    5.0   
         Maximum edit distance7                               0.0    0.0    0.0    0.0   
         Maximum edit distance8                               0.0    0.0    0.0    0.0   
         Maximum edit distance9                               0.0    1.0    0.0    0.0   
         Maximum edit distance10                              0.0    0.0    0.0    0.0   
         Maximum edit distance11                              0.0    0.0    0.0    0.0   
         Maximum edit distance12                              0.0    0.0    0.0    0.0   
         Maximum edit distance13                              0.0    0.0    0.0    0.0   
         Maximum edit distance14                              0.0    0.0    0.0    0.0   
         Maximum edit distance15                              0.0    0.0    0.0    0.0   
         Maximum edit distance16                              0.0    0.0    0.0    0.0   
         Maximum edit distance17                              0.0    0.0    1.0    0.0   
         Maximum AS-path length7                              1.0    0.0    0.0    0.0   
         Maximum AS-path length8                              0.0    0.0    0.0    1.0   
         Maximum AS-path length9                              0.0    0.0    0.0    0.0   
         Maximum AS-path length10                             0.0    0.0    0.0    0.0   
         Maximum AS-path length11                             0.0    0.0    0.0    0.0   
         Maximum AS-path length12                             0.0    1.0    0.0    0.0   
         Maximum AS-path length13                             0.0    0.0    0.0    0.0   
         Maximum AS-path length14                             0.0    0.0    0.0    0.0   
         Maximum AS-path length15                             0.0    0.0    0.0    0.0   
         Number of Interior Gateway Protocol (IGP) packets   34.0   55.0   48.0   46.0   
         Number of Exterior Gateway Protocol (EGP) packets    0.0    0.0    0.0    0.0   
         Number of incomplete packets                         6.0    4.0    4.0    3.0   
         Packet size (B)                                    287.0  256.0  263.0  252.0   
         Label                                               -1.0   -1.0   -1.0   -1.0   
         
                                                                4  
         Hour and Minutes                                     5.0  
         Hour                                                 0.0  
         Minutes                                              5.0  
         Seconds                                              4.0  
         Number of announcements                             80.0  
         Number of withdrawals                                3.0  
         Number of announced NLRI prefixes                  231.0  
         Number of withdrawn NLRI prefixes                   26.0  
         Average AS-path length                               7.0  
         Maximum AS-path length                              11.0  
         Average unique AS-path length                        7.0  
         Number of duplicate announcements                    8.0  
         Number of duplicate withdrawals                    228.0  
         Number of implicit withdrawals                       0.0  
         Average edit distance                               11.0  
         Maximum edit distance                                1.3  
         Inter-arrival time                                   7.0  
         Maximum edit distance7                               1.0  
         Maximum edit distance8                               0.0  
         Maximum edit distance9                               0.0  
         Maximum edit distance10                              0.0  
         Maximum edit distance11                              0.0  
         Maximum edit distance12                              0.0  
         Maximum edit distance13                              0.0  
         Maximum edit distance14                              0.0  
         Maximum edit distance15                              0.0  
         Maximum edit distance16                              0.0  
         Maximum edit distance17                              0.0  
         Maximum AS-path length7                              0.0  
         Maximum AS-path length8                              0.0  
         Maximum AS-path length9                              0.0  
         Maximum AS-path length10                             1.0  
         Maximum AS-path length11                             0.0  
         Maximum AS-path length12                             0.0  
         Maximum AS-path length13                             0.0  
         Maximum AS-path length14                             0.0  
         Maximum AS-path length15                             0.0  
         Number of Interior Gateway Protocol (IGP) packets   76.0  
         Number of Exterior Gateway Protocol (EGP) packets    0.0  
         Number of incomplete packets                         4.0  
         Packet size (B)                                    270.0  
         Label                                               -1.0  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{df}\PY{o}{.}\PY{n}{isna}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:} Hour and Minutes                                     0
         Hour                                                 0
         Minutes                                              0
         Seconds                                              0
         Number of announcements                              0
         Number of withdrawals                                0
         Number of announced NLRI prefixes                    0
         Number of withdrawn NLRI prefixes                    0
         Average AS-path length                               0
         Maximum AS-path length                               0
         Average unique AS-path length                        0
         Number of duplicate announcements                    0
         Number of duplicate withdrawals                      0
         Number of implicit withdrawals                       0
         Average edit distance                                0
         Maximum edit distance                                0
         Inter-arrival time                                   0
         Maximum edit distance7                               0
         Maximum edit distance8                               0
         Maximum edit distance9                               0
         Maximum edit distance10                              0
         Maximum edit distance11                              0
         Maximum edit distance12                              0
         Maximum edit distance13                              0
         Maximum edit distance14                              0
         Maximum edit distance15                              0
         Maximum edit distance16                              0
         Maximum edit distance17                              0
         Maximum AS-path length7                              0
         Maximum AS-path length8                              0
         Maximum AS-path length9                              0
         Maximum AS-path length10                             0
         Maximum AS-path length11                             0
         Maximum AS-path length12                             0
         Maximum AS-path length13                             0
         Maximum AS-path length14                             0
         Maximum AS-path length15                             0
         Number of Interior Gateway Protocol (IGP) packets    0
         Number of Exterior Gateway Protocol (EGP) packets    0
         Number of incomplete packets                         0
         Packet size (B)                                      0
         Label                                                0
         dtype: int64
\end{Verbatim}
            
    \subsubsection{Step 2: Understanding the Features in the
Dataset}\label{step-2-understanding-the-features-in-the-dataset}

\begin{quote}
Dataset Description: Columns 1-4: Time (column 1: hour+minute; column 2:
hour; column 3: minute; column 4: second) Columns 5-41: BGP features
Column 42: labels for the regular (-1) and anomalous (1) data.
\end{quote}

\begin{quote}
List of features extracted from BGP update messages: 1. Number of
announcements 2. Number of withdrawals 3. Number of announced NLRI
prefixes 4. Number of withdrawn NLRI prefixes 5. Average AS-path length
6. Maximum AS-path length 7. Average unique AS-path length 8. Number of
duplicate announcements 9. Number of implicit withdrawals 10. Number of
duplicate withdrawals 11. Maximum edit distance 12. Arrival rate 13.
Average edit distance 14-23. Maximum AS-path length = n, where n = (11,
...,20) 24-33. Maximum edit distance = n, where n = (7, ...,16) 34.
Number of Interior Gateway Protocol (IGP) packets 35. Number of Exterior
Gateway Protocol (EGP) packets 36. Number of incomplete packets 37.
Packet size (B)
\end{quote}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{msno}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{df}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:} <AxesSubplot:>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{c+c1}{\PYZsh{}Checking out the categories and their respective counts in Label feature}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Job:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{df}\PY{o}{.}\PY{n}{Label}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{sep} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Job:
-1    12882
 1     4365
Name: Label, dtype: int64

    \end{Verbatim}

    \subsubsection{Upscaling Minority class for Balanced
dataset}\label{upscaling-minority-class-for-balanced-dataset}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{utils} \PY{k}{import} \PY{n}{resample}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{df\PYZus{}minority} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{o}{.}\PY{n}{Label}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{df\PYZus{}majority} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{o}{.}\PY{n}{Label}\PY{o}{==}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{df\PYZus{}minority\PYZus{}upsampled} \PY{o}{=} \PY{n}{resample}\PY{p}{(}\PY{n}{df\PYZus{}minority}\PY{p}{,} \PY{n}{replace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{n\PYZus{}samples} \PY{o}{=} \PY{l+m+mi}{12882}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \paragraph{Combining majority and up-scaled minority to create a
balanced
dataset}\label{combining-majority-and-up-scaled-minority-to-create-a-balanced-dataset}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{dataset1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{df\PYZus{}minority\PYZus{}upsampled}\PY{p}{,} \PY{n}{df\PYZus{}majority}\PY{p}{]}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{dataset1}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n}{dataset1}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(25764, 42)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:}        Hour and Minutes  Hour  Minutes  Seconds  Number of announcements  \textbackslash{}
         0                   926     9       26        3                      489   
         1                  1726    17       26        4                       57   
         2                  1355    13       55        5                      277   
         3                  2053    20       53        3                       54   
         4                  2305    23        5        7                       90   
         {\ldots}                 {\ldots}   {\ldots}      {\ldots}      {\ldots}                      {\ldots}   
         25759              2355    23       55       12                       41   
         25760              2356    23       56        5                       31   
         25761              2357    23       57        0                       44   
         25762              2358    23       58        4                       65   
         25763              2359    23       59       14                       57   
         
                Number of withdrawals  Number of announced NLRI prefixes  \textbackslash{}
         0                          7                               1761   
         1                          6                                 97   
         2                          8                                802   
         3                          7                                206   
         4                          6                                266   
         {\ldots}                      {\ldots}                                {\ldots}   
         25759                      5                                202   
         25760                      3                                286   
         25761                      6                                 96   
         25762                      4                                170   
         25763                      6                                 89   
         
                Number of withdrawn NLRI prefixes  Average AS-path length  \textbackslash{}
         0                                    358                       6   
         1                                     19                       6   
         2                                     52                       6   
         3                                    198                       6   
         4                                     35                       7   
         {\ldots}                                  {\ldots}                     {\ldots}   
         25759                                 31                       5   
         25760                                  5                       6   
         25761                                 42                       6   
         25762                                 24                       6   
         25763                                 24                       6   
         
                Maximum AS-path length  {\ldots}  Maximum AS-path length11  \textbackslash{}
         0                          16  {\ldots}                         0   
         1                          10  {\ldots}                         0   
         2                          15  {\ldots}                         0   
         3                          10  {\ldots}                         0   
         4                          22  {\ldots}                         0   
         {\ldots}                       {\ldots}  {\ldots}                       {\ldots}   
         25759                      10  {\ldots}                         0   
         25760                       7  {\ldots}                         0   
         25761                       8  {\ldots}                         0   
         25762                       9  {\ldots}                         0   
         25763                       9  {\ldots}                         0   
         
                Maximum AS-path length12  Maximum AS-path length13  \textbackslash{}
         0                             0                         0   
         1                             0                         0   
         2                             0                         0   
         3                             0                         0   
         4                             0                         0   
         {\ldots}                         {\ldots}                       {\ldots}   
         25759                         0                         0   
         25760                         0                         0   
         25761                         0                         0   
         25762                         0                         0   
         25763                         0                         0   
         
                Maximum AS-path length14  Maximum AS-path length15  \textbackslash{}
         0                             0                         1   
         1                             0                         0   
         2                             1                         0   
         3                             0                         0   
         4                             0                         0   
         {\ldots}                         {\ldots}                       {\ldots}   
         25759                         0                         0   
         25760                         0                         0   
         25761                         0                         0   
         25762                         0                         0   
         25763                         0                         0   
         
                Number of Interior Gateway Protocol (IGP) packets  \textbackslash{}
         0                                                    449   
         1                                                     43   
         2                                                    256   
         3                                                     41   
         4                                                     76   
         {\ldots}                                                  {\ldots}   
         25759                                                 40   
         25760                                                 31   
         25761                                                 41   
         25762                                                 58   
         25763                                                 54   
         
                Number of Exterior Gateway Protocol (EGP) packets  \textbackslash{}
         0                                                      0   
         1                                                      0   
         2                                                      0   
         3                                                      1   
         4                                                      0   
         {\ldots}                                                  {\ldots}   
         25759                                                  0   
         25760                                                  0   
         25761                                                  0   
         25762                                                  0   
         25763                                                  0   
         
                Number of incomplete packets  Packet size (B)  Label  
         0                                40              302      1  
         1                                14              228      1  
         2                                21              266      1  
         3                                12              354      1  
         4                                14              265      1  
         {\ldots}                             {\ldots}              {\ldots}    {\ldots}  
         25759                             1              303     -1  
         25760                             0              348     -1  
         25761                             3              247     -1  
         25762                             7              255     -1  
         25763                             3              223     -1  
         
         [25764 rows x 42 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{c+c1}{\PYZsh{} Modified Dataset to figure out correlations}
         \PY{n}{X\PYZus{}train1} \PY{o}{=} \PY{n}{dataset1}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{dataset1}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{Y\PYZus{}train1} \PY{o}{=} \PY{n}{dataset1}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{]}
         \PY{n}{Y\PYZus{}train1} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0} \PY{k}{if} \PY{n}{ele}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{1} \PY{k}{for} \PY{n}{ele} \PY{o+ow}{in} \PY{n}{Y\PYZus{}train1}\PY{p}{]}
         \PY{n}{Y\PYZus{}train1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{Y\PYZus{}train1}\PY{p}{)}
         \PY{n}{X\PYZus{}test1} \PY{o}{=} \PY{n}{code\PYZus{}redi\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{code\PYZus{}redi\PYZus{}df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{]}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{Y\PYZus{}test1} \PY{o}{=} \PY{n}{code\PYZus{}redi\PYZus{}df}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{]}
         \PY{n}{Y\PYZus{}test1} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{0} \PY{k}{if} \PY{n}{ele}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0} \PY{k}{else} \PY{l+m+mi}{1} \PY{k}{for} \PY{n}{ele} \PY{o+ow}{in} \PY{n}{Y\PYZus{}test1}\PY{p}{]}
         \PY{n}{Y\PYZus{}test1} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{Y\PYZus{}test1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{X\PYZus{}train1}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{Y\PYZus{}train1}
         \PY{c+c1}{\PYZsh{} X\PYZus{}train1.reset\PYZus{}index(drop=True)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} 0        0
         1        0
         2        0
         3        0
         4        0
                 ..
         25759    1
         25760    1
         25761    1
         25762    1
         25763    1
         Length: 25764, dtype: int64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{24}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns\PYZus{}plot} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{dataset1}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{:}\PY{l+m+mi}{42}\PY{p}{]}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spearman}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{annot}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{fig} \PY{o}{=} \PY{n}{sns\PYZus{}plot}\PY{o}{.}\PY{n}{get\PYZus{}figure}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}fig.savefig(\PYZdq{}heatmap\PYZus{}corr\PYZus{}spearman.png\PYZdq{})}
         \PY{c+c1}{\PYZsh{} plt.savefig(\PYZdq{}Heat\PYZus{}map.png\PYZdq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Correlation Matrix for all 37 features}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} Text(0.5, 1.0, 'Correlation Matrix for all 37 features')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{c+c1}{\PYZsh{}calculate and plot the distribution of numerical and categorical features }
         
         \PY{n}{df\PYZus{}numerical} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{select\PYZus{}dtypes}\PY{p}{(}\PY{n}{exclude}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{object}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} 
         \PY{n}{df\PYZus{}categorical} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{select\PYZus{}dtypes}\PY{p}{(}\PY{n}{include}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{object}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Numerical features: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}numerical.columns)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Categorical features: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(df\PYZus{}categorical.columns)\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{pie}\PY{p}{(}\PY{p}{[}\PY{n+nb}{len}\PY{p}{(}\PY{n}{df\PYZus{}numerical}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{df\PYZus{}categorical}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{]}\PY{p}{,} 
                 \PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Numerical Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Categorical Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                 \PY{n}{colors}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}C9C0EE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}C0CB9D}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                 \PY{n}{textprops}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fontsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{13}\PY{p}{\PYZcb{}}\PY{p}{,}
                 \PY{n}{autopct}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}1.1f}\PY{l+s+si}{\PYZpc{}\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Number of Numerical features: 42
Number of Categorical features: 0

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_33_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{c+c1}{\PYZsh{}Visualize distributions of dataset via histograms }
         
         \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{50}\PY{p}{)}\PY{p}{)}
         \PY{k}{for} \PY{n}{idx}\PY{p}{,} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{df\PYZus{}numerical}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{:}
             \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{7}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{n}{idx}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{sns}\PY{o}{.}\PY{n}{kdeplot}\PY{p}{(}\PY{n}{data} \PY{o}{=} \PY{n}{df\PYZus{}numerical}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{idx}\PY{p}{]}\PY{p}{,}
                         \PY{n}{fill} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
             \PY{n}{df\PYZus{}numerical}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{idx}\PY{p}{]}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{maroon}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.9}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{0.2}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{i}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_34_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{pos} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{38}\PY{p}{]}
         \PY{n}{colnames} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{pos}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
         \PY{n+nb}{print} \PY{p}{(}\PY{n}{colnames}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['Maximum AS-path length', 'Number of duplicate announcements', 'Maximum edit distance', 'Number of Exterior Gateway Protocol (EGP) packets']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{whitegrid}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{scatterplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Hour}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Maximum AS\PYZhy{}path length}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{n}{data}\PY{o}{=}\PY{n}{df}\PY{p}{,} \PY{n}{hue}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Hour}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sizes}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{)}\PY{p}{,} \PY{n}{legend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{brief}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}28}]:} <AxesSubplot:xlabel='Hour', ylabel='Maximum AS-path length'>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{histplot}\PY{p}{(}\PY{n}{df}\PY{p}{,}\PY{n}{x} \PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Hour}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y} \PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of Exterior Gateway Protocol (EGP) packets}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{element}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{poly}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}29}]:} <AxesSubplot:xlabel='Hour', ylabel='Number of Exterior Gateway Protocol (EGP) packets'>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_37_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{histplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{df}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Hour}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of duplicate announcements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{element}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{step}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{stat}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{density}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{common\PYZus{}norm}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}30}]:} <AxesSubplot:xlabel='Hour', ylabel='Number of duplicate announcements'>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{pos} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{,}\PY{l+m+mi}{38}\PY{p}{]}
         \PY{n}{colnames} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{pos}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}
             \PY{n}{df}\PY{p}{,}
             \PY{n}{x\PYZus{}vars}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Hour}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}
             \PY{n}{y\PYZus{}vars}\PY{o}{=}\PY{n}{colnames}\PY{p}{,}
         \PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}31}]:} <seaborn.axisgrid.PairGrid at 0x2090cc76cf8>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_39_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \textbf{Method to visualize class imbalance }

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{c+c1}{\PYZsh{} a method to visualize class balance }
         
         \PY{k}{def} \PY{n+nf}{class\PYZus{}balance} \PY{p}{(}\PY{n}{hexcolorA}\PY{p}{,} \PY{n}{hexcolorB}\PY{p}{,} \PY{n}{edgecolor}\PY{p}{)}\PY{p}{:}
             
                
             \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
         
             \PY{n}{target\PYZus{}cnt} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}index}\PY{p}{(}\PY{p}{)}
         
             \PY{n}{ax}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{target\PYZus{}cnt}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{target\PYZus{}cnt}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{p}{[}\PY{n}{hexcolorA} \PY{k}{if} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{2}==0 else hexcolorB for i in range(9)],
                \PY{n}{width}\PY{o}{=}\PY{l+m+mf}{0.30}\PY{p}{,} 
                \PY{n}{edgecolor}\PY{o}{=}\PY{n}{edgecolor}\PY{p}{,} 
                \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         
             \PY{n}{ax}\PY{o}{.}\PY{n}{margins}\PY{p}{(}\PY{l+m+mf}{0.02}\PY{p}{,} \PY{l+m+mf}{0.05}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{}for i in range(2):}
             \PY{c+c1}{\PYZsh{}ax.annotate(f\PYZsq{}\PYZob{}target\PYZus{}cnt[i]/len(df)*100:.3\PYZcb{}\PYZsq{}, xy=(i, target\PYZus{}cnt[i]+1000),}
                            \PY{c+c1}{\PYZsh{}va=\PYZsq{}center\PYZsq{}, ha=\PYZsq{}center\PYZsq{},}
                        \PY{c+c1}{\PYZsh{})}
         
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Target Variable Distribution}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.4}\PY{p}{)}
         
             \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
             \PY{k}{return}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{class\PYZus{}balance}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}FFDDF4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}AFEEEE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_42_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{chart} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{countplot}\PY{p}{(}
             \PY{n}{data}\PY{o}{=}\PY{n}{df}\PY{p}{,}
             \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of withdrawals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
             \PY{n}{palette}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Set1}\PY{l+s+s1}{\PYZsq{}}
         \PY{p}{)}
         
         \PY{n}{chart}\PY{o}{.}\PY{n}{set\PYZus{}xticklabels}\PY{p}{(}\PY{n}{chart}\PY{o}{.}\PY{n}{get\PYZus{}xticklabels}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{rotation}\PY{o}{=}\PY{l+m+mi}{45}\PY{p}{,} \PY{n}{horizontalalignment}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontweight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{light}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{large}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}hide label object values}
         \PY{k+kc}{None}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_43_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{catplot}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of withdrawals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{kind} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{count}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{data} \PY{o}{=} \PY{n}{df}\PY{p}{,}\PY{n}{aspect} \PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:} <seaborn.axisgrid.FacetGrid at 0x2090cf165f8>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_44_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{df\PYZus{}numerical}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{T}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}205ff2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PYZbs{}
                                     \PY{o}{.}\PY{n}{background\PYZus{}gradient}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{std}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Reds}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PYZbs{}
                                     \PY{o}{.}\PY{n}{background\PYZus{}gradient}\PY{p}{(}\PY{n}{subset}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{viridis}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}36}]:} <pandas.io.formats.style.Styler at 0x2090e7592e8>
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_46_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{boxplot}\PY{p}{(}\PY{n}{data}\PY{o}{=}\PY{n}{df}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of announcements}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_47_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{discrete\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{df\PYZus{}numerical}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
             \PY{k}{if} \PY{n}{np}\PY{o}{.}\PY{n}{array\PYZus{}equal}\PY{p}{(}\PY{n}{df\PYZus{}numerical}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{p}{,} \PY{n}{df\PYZus{}numerical}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{values}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{int}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                 \PY{n}{discrete\PYZus{}features}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{col}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Total }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{len(discrete\PYZus{}features)\PYZcb{} : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{discrete\PYZus{}features}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Total 41 : 
['Hour and Minutes', 'Hour', 'Minutes', 'Seconds', 'Number of announcements', 'Number of withdrawals', 'Number of announced NLRI prefixes', 'Number of withdrawn NLRI prefixes', 'Average AS-path length', 'Maximum AS-path length', 'Average unique AS-path length', 'Number of duplicate announcements', 'Number of duplicate withdrawals', 'Number of implicit withdrawals', 'Average edit distance', 'Inter-arrival time', 'Maximum edit distance7', 'Maximum edit distance8', 'Maximum edit distance9', 'Maximum edit distance10', 'Maximum edit distance11', 'Maximum edit distance12', 'Maximum edit distance13', 'Maximum edit distance14', 'Maximum edit distance15', 'Maximum edit distance16', 'Maximum edit distance17', 'Maximum AS-path length7', 'Maximum AS-path length8', 'Maximum AS-path length9', 'Maximum AS-path length10', 'Maximum AS-path length11', 'Maximum AS-path length12', 'Maximum AS-path length13', 'Maximum AS-path length14', 'Maximum AS-path length15', 'Number of Interior Gateway Protocol (IGP) packets', 'Number of Exterior Gateway Protocol (EGP) packets', 'Number of incomplete packets', 'Packet size (B)', 'Label']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unique values as follows:\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{for} \PY{n}{dcol} \PY{o+ow}{in} \PY{n}{discrete\PYZus{}features}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{f}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}dcol\PYZcb{}}\PY{l+s+s1}{: }\PY{l+s+s1}{\PYZob{}}\PY{l+s+s1}{df\PYZus{}numerical[dcol].nunique()\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Unique values as follows:-
Hour and Minutes: 1440
Hour: 24
Minutes: 60
Seconds: 29
Number of announcements: 694
Number of withdrawals: 24
Number of announced NLRI prefixes: 1496
Number of withdrawn NLRI prefixes: 492
Average AS-path length: 8
Maximum AS-path length: 32
Average unique AS-path length: 9
Number of duplicate announcements: 223
Number of duplicate withdrawals: 985
Number of implicit withdrawals: 173
Average edit distance: 32
Inter-arrival time: 11
Maximum edit distance7: 2
Maximum edit distance8: 2
Maximum edit distance9: 2
Maximum edit distance10: 2
Maximum edit distance11: 2
Maximum edit distance12: 2
Maximum edit distance13: 2
Maximum edit distance14: 2
Maximum edit distance15: 2
Maximum edit distance16: 2
Maximum edit distance17: 2
Maximum AS-path length7: 2
Maximum AS-path length8: 2
Maximum AS-path length9: 2
Maximum AS-path length10: 2
Maximum AS-path length11: 2
Maximum AS-path length12: 2
Maximum AS-path length13: 2
Maximum AS-path length14: 2
Maximum AS-path length15: 2
Number of Interior Gateway Protocol (IGP) packets: 647
Number of Exterior Gateway Protocol (EGP) packets: 20
Number of incomplete packets: 123
Packet size (B): 308
Label: 2

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of announced NLRI prefixes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_50_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Heatmap of BGP Update Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)} 
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Horizontal Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)} 
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Vertical Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)} 
          
          \PY{n}{cor\PYZus{}matrix} \PY{o}{=} \PY{n}{df\PYZus{}numerical}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{cor\PYZus{}matrix} \PY{p}{,} \PY{n}{annot}\PY{o}{=} \PY{k+kc}{True}\PY{p}{,}\PY{n}{annot\PYZus{}kws}\PY{o}{=}\PY{p}{\PYZob{}}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fontsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{7}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fontweight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fontfamily}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{serif}\PY{l+s+s1}{\PYZsq{}}
                      \PY{p}{\PYZcb{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_51_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}127}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Heatmap of BGP Update Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)} 
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Horizontal Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)} 
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Vertical Values}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize} \PY{o}{=} \PY{l+m+mi}{15}\PY{p}{)} 
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{)}
          \PY{n}{upper\PYZus{}tri} \PY{o}{=} \PY{n}{cor\PYZus{}matrix}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{triu}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{ones}\PY{p}{(}\PY{n}{cor\PYZus{}matrix}\PY{o}{.}\PY{n}{shape}\PY{p}{)}\PY{p}{,}\PY{n}{k}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{bool}\PY{p}{)}\PY{p}{)}
          \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{upper\PYZus{}tri} \PY{p}{,} \PY{n}{annot}\PY{o}{=} \PY{k+kc}{True}\PY{p}{,}\PY{n}{annot\PYZus{}kws}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fontsize}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{7}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fontweight}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                          \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fontfamily}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{serif}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}127}]:} <AxesSubplot:>
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_52_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_52_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{c+c1}{\PYZsh{}check for highly correlated columns}
         
         \PY{n}{corr} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{corr}\PY{p}{(}\PY{p}{)}
         \PY{n}{corr\PYZus{}greater\PYZus{}than\PYZus{}75} \PY{o}{=} \PY{n}{corr}\PY{p}{[}\PY{n}{corr}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{o}{.}\PY{l+m+mi}{75}\PY{p}{]}
         \PY{n}{corr\PYZus{}greater\PYZus{}than\PYZus{}75}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}44}]:}                                                    Hour and Minutes      Hour  \textbackslash{}
         Hour and Minutes                                           1.000000  0.999688   
         Hour                                                       0.999688  1.000000   
         Minutes                                                         NaN       NaN   
         Seconds                                                         NaN       NaN   
         Number of announcements                                         NaN       NaN   
         Number of withdrawals                                           NaN       NaN   
         Number of announced NLRI prefixes                               NaN       NaN   
         Number of withdrawn NLRI prefixes                               NaN       NaN   
         Average AS-path length                                          NaN       NaN   
         Maximum AS-path length                                          NaN       NaN   
         Average unique AS-path length                                   NaN       NaN   
         Number of duplicate announcements                               NaN       NaN   
         Number of duplicate withdrawals                                 NaN       NaN   
         Number of implicit withdrawals                                  NaN       NaN   
         Average edit distance                                           NaN       NaN   
         Maximum edit distance                                           NaN       NaN   
         Inter-arrival time                                              NaN       NaN   
         Maximum edit distance7                                          NaN       NaN   
         Maximum edit distance8                                          NaN       NaN   
         Maximum edit distance9                                          NaN       NaN   
         Maximum edit distance10                                         NaN       NaN   
         Maximum edit distance11                                         NaN       NaN   
         Maximum edit distance12                                         NaN       NaN   
         Maximum edit distance13                                         NaN       NaN   
         Maximum edit distance14                                         NaN       NaN   
         Maximum edit distance15                                         NaN       NaN   
         Maximum edit distance16                                         NaN       NaN   
         Maximum edit distance17                                         NaN       NaN   
         Maximum AS-path length7                                         NaN       NaN   
         Maximum AS-path length8                                         NaN       NaN   
         Maximum AS-path length9                                         NaN       NaN   
         Maximum AS-path length10                                        NaN       NaN   
         Maximum AS-path length11                                        NaN       NaN   
         Maximum AS-path length12                                        NaN       NaN   
         Maximum AS-path length13                                        NaN       NaN   
         Maximum AS-path length14                                        NaN       NaN   
         Maximum AS-path length15                                        NaN       NaN   
         Number of Interior Gateway Protocol (IGP) packets               NaN       NaN   
         Number of Exterior Gateway Protocol (EGP) packets               NaN       NaN   
         Number of incomplete packets                                    NaN       NaN   
         Packet size (B)                                                 NaN       NaN   
         Label                                                           NaN       NaN   
         
                                                            Minutes  Seconds  \textbackslash{}
         Hour and Minutes                                       NaN      NaN   
         Hour                                                   NaN      NaN   
         Minutes                                                1.0      NaN   
         Seconds                                                NaN      1.0   
         Number of announcements                                NaN      NaN   
         Number of withdrawals                                  NaN      NaN   
         Number of announced NLRI prefixes                      NaN      NaN   
         Number of withdrawn NLRI prefixes                      NaN      NaN   
         Average AS-path length                                 NaN      NaN   
         Maximum AS-path length                                 NaN      NaN   
         Average unique AS-path length                          NaN      NaN   
         Number of duplicate announcements                      NaN      NaN   
         Number of duplicate withdrawals                        NaN      NaN   
         Number of implicit withdrawals                         NaN      NaN   
         Average edit distance                                  NaN      NaN   
         Maximum edit distance                                  NaN      NaN   
         Inter-arrival time                                     NaN      NaN   
         Maximum edit distance7                                 NaN      NaN   
         Maximum edit distance8                                 NaN      NaN   
         Maximum edit distance9                                 NaN      NaN   
         Maximum edit distance10                                NaN      NaN   
         Maximum edit distance11                                NaN      NaN   
         Maximum edit distance12                                NaN      NaN   
         Maximum edit distance13                                NaN      NaN   
         Maximum edit distance14                                NaN      NaN   
         Maximum edit distance15                                NaN      NaN   
         Maximum edit distance16                                NaN      NaN   
         Maximum edit distance17                                NaN      NaN   
         Maximum AS-path length7                                NaN      NaN   
         Maximum AS-path length8                                NaN      NaN   
         Maximum AS-path length9                                NaN      NaN   
         Maximum AS-path length10                               NaN      NaN   
         Maximum AS-path length11                               NaN      NaN   
         Maximum AS-path length12                               NaN      NaN   
         Maximum AS-path length13                               NaN      NaN   
         Maximum AS-path length14                               NaN      NaN   
         Maximum AS-path length15                               NaN      NaN   
         Number of Interior Gateway Protocol (IGP) packets      NaN      NaN   
         Number of Exterior Gateway Protocol (EGP) packets      NaN      NaN   
         Number of incomplete packets                           NaN      NaN   
         Packet size (B)                                        NaN      NaN   
         Label                                                  NaN      NaN   
         
                                                            Number of announcements  \textbackslash{}
         Hour and Minutes                                                       NaN   
         Hour                                                                   NaN   
         Minutes                                                                NaN   
         Seconds                                                                NaN   
         Number of announcements                                           1.000000   
         Number of withdrawals                                                  NaN   
         Number of announced NLRI prefixes                                 0.987673   
         Number of withdrawn NLRI prefixes                                      NaN   
         Average AS-path length                                                 NaN   
         Maximum AS-path length                                                 NaN   
         Average unique AS-path length                                          NaN   
         Number of duplicate announcements                                      NaN   
         Number of duplicate withdrawals                                        NaN   
         Number of implicit withdrawals                                         NaN   
         Average edit distance                                                  NaN   
         Maximum edit distance                                                  NaN   
         Inter-arrival time                                                     NaN   
         Maximum edit distance7                                                 NaN   
         Maximum edit distance8                                                 NaN   
         Maximum edit distance9                                                 NaN   
         Maximum edit distance10                                                NaN   
         Maximum edit distance11                                                NaN   
         Maximum edit distance12                                                NaN   
         Maximum edit distance13                                                NaN   
         Maximum edit distance14                                                NaN   
         Maximum edit distance15                                                NaN   
         Maximum edit distance16                                                NaN   
         Maximum edit distance17                                                NaN   
         Maximum AS-path length7                                                NaN   
         Maximum AS-path length8                                                NaN   
         Maximum AS-path length9                                                NaN   
         Maximum AS-path length10                                               NaN   
         Maximum AS-path length11                                               NaN   
         Maximum AS-path length12                                               NaN   
         Maximum AS-path length13                                               NaN   
         Maximum AS-path length14                                               NaN   
         Maximum AS-path length15                                               NaN   
         Number of Interior Gateway Protocol (IGP) packets                 0.999815   
         Number of Exterior Gateway Protocol (EGP) packets                      NaN   
         Number of incomplete packets                                      0.973340   
         Packet size (B)                                                        NaN   
         Label                                                                  NaN   
         
                                                            Number of withdrawals  \textbackslash{}
         Hour and Minutes                                                     NaN   
         Hour                                                                 NaN   
         Minutes                                                              NaN   
         Seconds                                                              NaN   
         Number of announcements                                              NaN   
         Number of withdrawals                                           1.000000   
         Number of announced NLRI prefixes                                    NaN   
         Number of withdrawn NLRI prefixes                               0.982035   
         Average AS-path length                                               NaN   
         Maximum AS-path length                                               NaN   
         Average unique AS-path length                                        NaN   
         Number of duplicate announcements                                    NaN   
         Number of duplicate withdrawals                                      NaN   
         Number of implicit withdrawals                                       NaN   
         Average edit distance                                                NaN   
         Maximum edit distance                                                NaN   
         Inter-arrival time                                                   NaN   
         Maximum edit distance7                                               NaN   
         Maximum edit distance8                                               NaN   
         Maximum edit distance9                                               NaN   
         Maximum edit distance10                                              NaN   
         Maximum edit distance11                                              NaN   
         Maximum edit distance12                                              NaN   
         Maximum edit distance13                                              NaN   
         Maximum edit distance14                                              NaN   
         Maximum edit distance15                                              NaN   
         Maximum edit distance16                                              NaN   
         Maximum edit distance17                                              NaN   
         Maximum AS-path length7                                              NaN   
         Maximum AS-path length8                                              NaN   
         Maximum AS-path length9                                              NaN   
         Maximum AS-path length10                                             NaN   
         Maximum AS-path length11                                             NaN   
         Maximum AS-path length12                                             NaN   
         Maximum AS-path length13                                             NaN   
         Maximum AS-path length14                                             NaN   
         Maximum AS-path length15                                             NaN   
         Number of Interior Gateway Protocol (IGP) packets                    NaN   
         Number of Exterior Gateway Protocol (EGP) packets                    NaN   
         Number of incomplete packets                                         NaN   
         Packet size (B)                                                      NaN   
         Label                                                                NaN   
         
                                                            Number of announced NLRI prefixes  \textbackslash{}
         Hour and Minutes                                                                 NaN   
         Hour                                                                             NaN   
         Minutes                                                                          NaN   
         Seconds                                                                          NaN   
         Number of announcements                                                     0.987673   
         Number of withdrawals                                                            NaN   
         Number of announced NLRI prefixes                                           1.000000   
         Number of withdrawn NLRI prefixes                                                NaN   
         Average AS-path length                                                           NaN   
         Maximum AS-path length                                                           NaN   
         Average unique AS-path length                                                    NaN   
         Number of duplicate announcements                                                NaN   
         Number of duplicate withdrawals                                                  NaN   
         Number of implicit withdrawals                                                   NaN   
         Average edit distance                                                            NaN   
         Maximum edit distance                                                            NaN   
         Inter-arrival time                                                               NaN   
         Maximum edit distance7                                                           NaN   
         Maximum edit distance8                                                           NaN   
         Maximum edit distance9                                                           NaN   
         Maximum edit distance10                                                          NaN   
         Maximum edit distance11                                                          NaN   
         Maximum edit distance12                                                          NaN   
         Maximum edit distance13                                                          NaN   
         Maximum edit distance14                                                          NaN   
         Maximum edit distance15                                                          NaN   
         Maximum edit distance16                                                          NaN   
         Maximum edit distance17                                                          NaN   
         Maximum AS-path length7                                                          NaN   
         Maximum AS-path length8                                                          NaN   
         Maximum AS-path length9                                                          NaN   
         Maximum AS-path length10                                                         NaN   
         Maximum AS-path length11                                                         NaN   
         Maximum AS-path length12                                                         NaN   
         Maximum AS-path length13                                                         NaN   
         Maximum AS-path length14                                                         NaN   
         Maximum AS-path length15                                                         NaN   
         Number of Interior Gateway Protocol (IGP) packets                           0.987264   
         Number of Exterior Gateway Protocol (EGP) packets                                NaN   
         Number of incomplete packets                                                0.963797   
         Packet size (B)                                                                  NaN   
         Label                                                                            NaN   
         
                                                            Number of withdrawn NLRI prefixes  \textbackslash{}
         Hour and Minutes                                                                 NaN   
         Hour                                                                             NaN   
         Minutes                                                                          NaN   
         Seconds                                                                          NaN   
         Number of announcements                                                          NaN   
         Number of withdrawals                                                       0.982035   
         Number of announced NLRI prefixes                                                NaN   
         Number of withdrawn NLRI prefixes                                           1.000000   
         Average AS-path length                                                           NaN   
         Maximum AS-path length                                                           NaN   
         Average unique AS-path length                                                    NaN   
         Number of duplicate announcements                                                NaN   
         Number of duplicate withdrawals                                                  NaN   
         Number of implicit withdrawals                                                   NaN   
         Average edit distance                                                            NaN   
         Maximum edit distance                                                            NaN   
         Inter-arrival time                                                               NaN   
         Maximum edit distance7                                                           NaN   
         Maximum edit distance8                                                           NaN   
         Maximum edit distance9                                                           NaN   
         Maximum edit distance10                                                          NaN   
         Maximum edit distance11                                                          NaN   
         Maximum edit distance12                                                          NaN   
         Maximum edit distance13                                                          NaN   
         Maximum edit distance14                                                          NaN   
         Maximum edit distance15                                                          NaN   
         Maximum edit distance16                                                          NaN   
         Maximum edit distance17                                                          NaN   
         Maximum AS-path length7                                                          NaN   
         Maximum AS-path length8                                                          NaN   
         Maximum AS-path length9                                                          NaN   
         Maximum AS-path length10                                                         NaN   
         Maximum AS-path length11                                                         NaN   
         Maximum AS-path length12                                                         NaN   
         Maximum AS-path length13                                                         NaN   
         Maximum AS-path length14                                                         NaN   
         Maximum AS-path length15                                                         NaN   
         Number of Interior Gateway Protocol (IGP) packets                                NaN   
         Number of Exterior Gateway Protocol (EGP) packets                                NaN   
         Number of incomplete packets                                                     NaN   
         Packet size (B)                                                                  NaN   
         Label                                                                            NaN   
         
                                                            Average AS-path length  \textbackslash{}
         Hour and Minutes                                                      NaN   
         Hour                                                                  NaN   
         Minutes                                                               NaN   
         Seconds                                                               NaN   
         Number of announcements                                               NaN   
         Number of withdrawals                                                 NaN   
         Number of announced NLRI prefixes                                     NaN   
         Number of withdrawn NLRI prefixes                                     NaN   
         Average AS-path length                                           1.000000   
         Maximum AS-path length                                                NaN   
         Average unique AS-path length                                    0.890248   
         Number of duplicate announcements                                     NaN   
         Number of duplicate withdrawals                                       NaN   
         Number of implicit withdrawals                                        NaN   
         Average edit distance                                                 NaN   
         Maximum edit distance                                                 NaN   
         Inter-arrival time                                                    NaN   
         Maximum edit distance7                                                NaN   
         Maximum edit distance8                                                NaN   
         Maximum edit distance9                                                NaN   
         Maximum edit distance10                                               NaN   
         Maximum edit distance11                                               NaN   
         Maximum edit distance12                                               NaN   
         Maximum edit distance13                                               NaN   
         Maximum edit distance14                                               NaN   
         Maximum edit distance15                                               NaN   
         Maximum edit distance16                                               NaN   
         Maximum edit distance17                                               NaN   
         Maximum AS-path length7                                               NaN   
         Maximum AS-path length8                                               NaN   
         Maximum AS-path length9                                               NaN   
         Maximum AS-path length10                                              NaN   
         Maximum AS-path length11                                              NaN   
         Maximum AS-path length12                                              NaN   
         Maximum AS-path length13                                              NaN   
         Maximum AS-path length14                                              NaN   
         Maximum AS-path length15                                              NaN   
         Number of Interior Gateway Protocol (IGP) packets                     NaN   
         Number of Exterior Gateway Protocol (EGP) packets                     NaN   
         Number of incomplete packets                                          NaN   
         Packet size (B)                                                       NaN   
         Label                                                                 NaN   
         
                                                            Maximum AS-path length  \textbackslash{}
         Hour and Minutes                                                      NaN   
         Hour                                                                  NaN   
         Minutes                                                               NaN   
         Seconds                                                               NaN   
         Number of announcements                                               NaN   
         Number of withdrawals                                                 NaN   
         Number of announced NLRI prefixes                                     NaN   
         Number of withdrawn NLRI prefixes                                     NaN   
         Average AS-path length                                                NaN   
         Maximum AS-path length                                           1.000000   
         Average unique AS-path length                                         NaN   
         Number of duplicate announcements                                     NaN   
         Number of duplicate withdrawals                                       NaN   
         Number of implicit withdrawals                                        NaN   
         Average edit distance                                            0.998034   
         Maximum edit distance                                                 NaN   
         Inter-arrival time                                                    NaN   
         Maximum edit distance7                                                NaN   
         Maximum edit distance8                                                NaN   
         Maximum edit distance9                                                NaN   
         Maximum edit distance10                                               NaN   
         Maximum edit distance11                                               NaN   
         Maximum edit distance12                                               NaN   
         Maximum edit distance13                                               NaN   
         Maximum edit distance14                                               NaN   
         Maximum edit distance15                                               NaN   
         Maximum edit distance16                                               NaN   
         Maximum edit distance17                                               NaN   
         Maximum AS-path length7                                               NaN   
         Maximum AS-path length8                                               NaN   
         Maximum AS-path length9                                               NaN   
         Maximum AS-path length10                                              NaN   
         Maximum AS-path length11                                              NaN   
         Maximum AS-path length12                                              NaN   
         Maximum AS-path length13                                              NaN   
         Maximum AS-path length14                                              NaN   
         Maximum AS-path length15                                              NaN   
         Number of Interior Gateway Protocol (IGP) packets                     NaN   
         Number of Exterior Gateway Protocol (EGP) packets                     NaN   
         Number of incomplete packets                                          NaN   
         Packet size (B)                                                       NaN   
         Label                                                                 NaN   
         
                                                            {\ldots}  \textbackslash{}
         Hour and Minutes                                   {\ldots}   
         Hour                                               {\ldots}   
         Minutes                                            {\ldots}   
         Seconds                                            {\ldots}   
         Number of announcements                            {\ldots}   
         Number of withdrawals                              {\ldots}   
         Number of announced NLRI prefixes                  {\ldots}   
         Number of withdrawn NLRI prefixes                  {\ldots}   
         Average AS-path length                             {\ldots}   
         Maximum AS-path length                             {\ldots}   
         Average unique AS-path length                      {\ldots}   
         Number of duplicate announcements                  {\ldots}   
         Number of duplicate withdrawals                    {\ldots}   
         Number of implicit withdrawals                     {\ldots}   
         Average edit distance                              {\ldots}   
         Maximum edit distance                              {\ldots}   
         Inter-arrival time                                 {\ldots}   
         Maximum edit distance7                             {\ldots}   
         Maximum edit distance8                             {\ldots}   
         Maximum edit distance9                             {\ldots}   
         Maximum edit distance10                            {\ldots}   
         Maximum edit distance11                            {\ldots}   
         Maximum edit distance12                            {\ldots}   
         Maximum edit distance13                            {\ldots}   
         Maximum edit distance14                            {\ldots}   
         Maximum edit distance15                            {\ldots}   
         Maximum edit distance16                            {\ldots}   
         Maximum edit distance17                            {\ldots}   
         Maximum AS-path length7                            {\ldots}   
         Maximum AS-path length8                            {\ldots}   
         Maximum AS-path length9                            {\ldots}   
         Maximum AS-path length10                           {\ldots}   
         Maximum AS-path length11                           {\ldots}   
         Maximum AS-path length12                           {\ldots}   
         Maximum AS-path length13                           {\ldots}   
         Maximum AS-path length14                           {\ldots}   
         Maximum AS-path length15                           {\ldots}   
         Number of Interior Gateway Protocol (IGP) packets  {\ldots}   
         Number of Exterior Gateway Protocol (EGP) packets  {\ldots}   
         Number of incomplete packets                       {\ldots}   
         Packet size (B)                                    {\ldots}   
         Label                                              {\ldots}   
         
                                                            Maximum AS-path length11  \textbackslash{}
         Hour and Minutes                                                        NaN   
         Hour                                                                    NaN   
         Minutes                                                                 NaN   
         Seconds                                                                 NaN   
         Number of announcements                                                 NaN   
         Number of withdrawals                                                   NaN   
         Number of announced NLRI prefixes                                       NaN   
         Number of withdrawn NLRI prefixes                                       NaN   
         Average AS-path length                                                  NaN   
         Maximum AS-path length                                                  NaN   
         Average unique AS-path length                                           NaN   
         Number of duplicate announcements                                       NaN   
         Number of duplicate withdrawals                                         NaN   
         Number of implicit withdrawals                                          NaN   
         Average edit distance                                                   NaN   
         Maximum edit distance                                                   NaN   
         Inter-arrival time                                                      NaN   
         Maximum edit distance7                                                  NaN   
         Maximum edit distance8                                             0.996334   
         Maximum edit distance9                                                  NaN   
         Maximum edit distance10                                                 NaN   
         Maximum edit distance11                                                 NaN   
         Maximum edit distance12                                                 NaN   
         Maximum edit distance13                                                 NaN   
         Maximum edit distance14                                                 NaN   
         Maximum edit distance15                                                 NaN   
         Maximum edit distance16                                                 NaN   
         Maximum edit distance17                                                 NaN   
         Maximum AS-path length7                                                 NaN   
         Maximum AS-path length8                                                 NaN   
         Maximum AS-path length9                                                 NaN   
         Maximum AS-path length10                                                NaN   
         Maximum AS-path length11                                           1.000000   
         Maximum AS-path length12                                                NaN   
         Maximum AS-path length13                                                NaN   
         Maximum AS-path length14                                                NaN   
         Maximum AS-path length15                                                NaN   
         Number of Interior Gateway Protocol (IGP) packets                       NaN   
         Number of Exterior Gateway Protocol (EGP) packets                       NaN   
         Number of incomplete packets                                            NaN   
         Packet size (B)                                                         NaN   
         Label                                                                   NaN   
         
                                                            Maximum AS-path length12  \textbackslash{}
         Hour and Minutes                                                        NaN   
         Hour                                                                    NaN   
         Minutes                                                                 NaN   
         Seconds                                                                 NaN   
         Number of announcements                                                 NaN   
         Number of withdrawals                                                   NaN   
         Number of announced NLRI prefixes                                       NaN   
         Number of withdrawn NLRI prefixes                                       NaN   
         Average AS-path length                                                  NaN   
         Maximum AS-path length                                                  NaN   
         Average unique AS-path length                                           NaN   
         Number of duplicate announcements                                       NaN   
         Number of duplicate withdrawals                                         NaN   
         Number of implicit withdrawals                                          NaN   
         Average edit distance                                                   NaN   
         Maximum edit distance                                                   NaN   
         Inter-arrival time                                                      NaN   
         Maximum edit distance7                                                  NaN   
         Maximum edit distance8                                                  NaN   
         Maximum edit distance9                                             0.998816   
         Maximum edit distance10                                                 NaN   
         Maximum edit distance11                                                 NaN   
         Maximum edit distance12                                                 NaN   
         Maximum edit distance13                                                 NaN   
         Maximum edit distance14                                                 NaN   
         Maximum edit distance15                                                 NaN   
         Maximum edit distance16                                                 NaN   
         Maximum edit distance17                                                 NaN   
         Maximum AS-path length7                                                 NaN   
         Maximum AS-path length8                                                 NaN   
         Maximum AS-path length9                                                 NaN   
         Maximum AS-path length10                                                NaN   
         Maximum AS-path length11                                                NaN   
         Maximum AS-path length12                                           1.000000   
         Maximum AS-path length13                                                NaN   
         Maximum AS-path length14                                                NaN   
         Maximum AS-path length15                                                NaN   
         Number of Interior Gateway Protocol (IGP) packets                       NaN   
         Number of Exterior Gateway Protocol (EGP) packets                       NaN   
         Number of incomplete packets                                            NaN   
         Packet size (B)                                                         NaN   
         Label                                                                   NaN   
         
                                                            Maximum AS-path length13  \textbackslash{}
         Hour and Minutes                                                        NaN   
         Hour                                                                    NaN   
         Minutes                                                                 NaN   
         Seconds                                                                 NaN   
         Number of announcements                                                 NaN   
         Number of withdrawals                                                   NaN   
         Number of announced NLRI prefixes                                       NaN   
         Number of withdrawn NLRI prefixes                                       NaN   
         Average AS-path length                                                  NaN   
         Maximum AS-path length                                                  NaN   
         Average unique AS-path length                                           NaN   
         Number of duplicate announcements                                       NaN   
         Number of duplicate withdrawals                                         NaN   
         Number of implicit withdrawals                                          NaN   
         Average edit distance                                                   NaN   
         Maximum edit distance                                                   NaN   
         Inter-arrival time                                                      NaN   
         Maximum edit distance7                                                  NaN   
         Maximum edit distance8                                                  NaN   
         Maximum edit distance9                                                  NaN   
         Maximum edit distance10                                            0.997946   
         Maximum edit distance11                                                 NaN   
         Maximum edit distance12                                                 NaN   
         Maximum edit distance13                                                 NaN   
         Maximum edit distance14                                                 NaN   
         Maximum edit distance15                                                 NaN   
         Maximum edit distance16                                                 NaN   
         Maximum edit distance17                                                 NaN   
         Maximum AS-path length7                                                 NaN   
         Maximum AS-path length8                                                 NaN   
         Maximum AS-path length9                                                 NaN   
         Maximum AS-path length10                                                NaN   
         Maximum AS-path length11                                                NaN   
         Maximum AS-path length12                                                NaN   
         Maximum AS-path length13                                           1.000000   
         Maximum AS-path length14                                                NaN   
         Maximum AS-path length15                                                NaN   
         Number of Interior Gateway Protocol (IGP) packets                       NaN   
         Number of Exterior Gateway Protocol (EGP) packets                       NaN   
         Number of incomplete packets                                            NaN   
         Packet size (B)                                                         NaN   
         Label                                                                   NaN   
         
                                                            Maximum AS-path length14  \textbackslash{}
         Hour and Minutes                                                        NaN   
         Hour                                                                    NaN   
         Minutes                                                                 NaN   
         Seconds                                                                 NaN   
         Number of announcements                                                 NaN   
         Number of withdrawals                                                   NaN   
         Number of announced NLRI prefixes                                       NaN   
         Number of withdrawn NLRI prefixes                                       NaN   
         Average AS-path length                                                  NaN   
         Maximum AS-path length                                                  NaN   
         Average unique AS-path length                                           NaN   
         Number of duplicate announcements                                       NaN   
         Number of duplicate withdrawals                                         NaN   
         Number of implicit withdrawals                                          NaN   
         Average edit distance                                                   NaN   
         Maximum edit distance                                                   NaN   
         Inter-arrival time                                                      NaN   
         Maximum edit distance7                                                  NaN   
         Maximum edit distance8                                                  NaN   
         Maximum edit distance9                                                  NaN   
         Maximum edit distance10                                                 NaN   
         Maximum edit distance11                                            0.996124   
         Maximum edit distance12                                                 NaN   
         Maximum edit distance13                                                 NaN   
         Maximum edit distance14                                                 NaN   
         Maximum edit distance15                                                 NaN   
         Maximum edit distance16                                                 NaN   
         Maximum edit distance17                                                 NaN   
         Maximum AS-path length7                                                 NaN   
         Maximum AS-path length8                                                 NaN   
         Maximum AS-path length9                                                 NaN   
         Maximum AS-path length10                                                NaN   
         Maximum AS-path length11                                                NaN   
         Maximum AS-path length12                                                NaN   
         Maximum AS-path length13                                                NaN   
         Maximum AS-path length14                                           1.000000   
         Maximum AS-path length15                                                NaN   
         Number of Interior Gateway Protocol (IGP) packets                       NaN   
         Number of Exterior Gateway Protocol (EGP) packets                       NaN   
         Number of incomplete packets                                            NaN   
         Packet size (B)                                                         NaN   
         Label                                                                   NaN   
         
                                                            Maximum AS-path length15  \textbackslash{}
         Hour and Minutes                                                        NaN   
         Hour                                                                    NaN   
         Minutes                                                                 NaN   
         Seconds                                                                 NaN   
         Number of announcements                                                 NaN   
         Number of withdrawals                                                   NaN   
         Number of announced NLRI prefixes                                       NaN   
         Number of withdrawn NLRI prefixes                                       NaN   
         Average AS-path length                                                  NaN   
         Maximum AS-path length                                                  NaN   
         Average unique AS-path length                                           NaN   
         Number of duplicate announcements                                       NaN   
         Number of duplicate withdrawals                                         NaN   
         Number of implicit withdrawals                                          NaN   
         Average edit distance                                                   NaN   
         Maximum edit distance                                                   NaN   
         Inter-arrival time                                                      NaN   
         Maximum edit distance7                                                  NaN   
         Maximum edit distance8                                                  NaN   
         Maximum edit distance9                                                  NaN   
         Maximum edit distance10                                                 NaN   
         Maximum edit distance11                                                 NaN   
         Maximum edit distance12                                            0.995094   
         Maximum edit distance13                                                 NaN   
         Maximum edit distance14                                                 NaN   
         Maximum edit distance15                                                 NaN   
         Maximum edit distance16                                                 NaN   
         Maximum edit distance17                                                 NaN   
         Maximum AS-path length7                                                 NaN   
         Maximum AS-path length8                                                 NaN   
         Maximum AS-path length9                                                 NaN   
         Maximum AS-path length10                                                NaN   
         Maximum AS-path length11                                                NaN   
         Maximum AS-path length12                                                NaN   
         Maximum AS-path length13                                                NaN   
         Maximum AS-path length14                                                NaN   
         Maximum AS-path length15                                           1.000000   
         Number of Interior Gateway Protocol (IGP) packets                       NaN   
         Number of Exterior Gateway Protocol (EGP) packets                       NaN   
         Number of incomplete packets                                            NaN   
         Packet size (B)                                                         NaN   
         Label                                                                   NaN   
         
                                                            Number of Interior Gateway Protocol (IGP) packets  \textbackslash{}
         Hour and Minutes                                                                                 NaN   
         Hour                                                                                             NaN   
         Minutes                                                                                          NaN   
         Seconds                                                                                          NaN   
         Number of announcements                                                                     0.999815   
         Number of withdrawals                                                                            NaN   
         Number of announced NLRI prefixes                                                           0.987264   
         Number of withdrawn NLRI prefixes                                                                NaN   
         Average AS-path length                                                                           NaN   
         Maximum AS-path length                                                                           NaN   
         Average unique AS-path length                                                                    NaN   
         Number of duplicate announcements                                                                NaN   
         Number of duplicate withdrawals                                                                  NaN   
         Number of implicit withdrawals                                                                   NaN   
         Average edit distance                                                                            NaN   
         Maximum edit distance                                                                            NaN   
         Inter-arrival time                                                                               NaN   
         Maximum edit distance7                                                                           NaN   
         Maximum edit distance8                                                                           NaN   
         Maximum edit distance9                                                                           NaN   
         Maximum edit distance10                                                                          NaN   
         Maximum edit distance11                                                                          NaN   
         Maximum edit distance12                                                                          NaN   
         Maximum edit distance13                                                                          NaN   
         Maximum edit distance14                                                                          NaN   
         Maximum edit distance15                                                                          NaN   
         Maximum edit distance16                                                                          NaN   
         Maximum edit distance17                                                                          NaN   
         Maximum AS-path length7                                                                          NaN   
         Maximum AS-path length8                                                                          NaN   
         Maximum AS-path length9                                                                          NaN   
         Maximum AS-path length10                                                                         NaN   
         Maximum AS-path length11                                                                         NaN   
         Maximum AS-path length12                                                                         NaN   
         Maximum AS-path length13                                                                         NaN   
         Maximum AS-path length14                                                                         NaN   
         Maximum AS-path length15                                                                         NaN   
         Number of Interior Gateway Protocol (IGP) packets                                           1.000000   
         Number of Exterior Gateway Protocol (EGP) packets                                                NaN   
         Number of incomplete packets                                                                0.968771   
         Packet size (B)                                                                                  NaN   
         Label                                                                                            NaN   
         
                                                            Number of Exterior Gateway Protocol (EGP) packets  \textbackslash{}
         Hour and Minutes                                                                                 NaN   
         Hour                                                                                             NaN   
         Minutes                                                                                          NaN   
         Seconds                                                                                          NaN   
         Number of announcements                                                                          NaN   
         Number of withdrawals                                                                            NaN   
         Number of announced NLRI prefixes                                                                NaN   
         Number of withdrawn NLRI prefixes                                                                NaN   
         Average AS-path length                                                                           NaN   
         Maximum AS-path length                                                                           NaN   
         Average unique AS-path length                                                                    NaN   
         Number of duplicate announcements                                                                NaN   
         Number of duplicate withdrawals                                                                  NaN   
         Number of implicit withdrawals                                                                   NaN   
         Average edit distance                                                                            NaN   
         Maximum edit distance                                                                            NaN   
         Inter-arrival time                                                                               NaN   
         Maximum edit distance7                                                                           NaN   
         Maximum edit distance8                                                                           NaN   
         Maximum edit distance9                                                                           NaN   
         Maximum edit distance10                                                                          NaN   
         Maximum edit distance11                                                                          NaN   
         Maximum edit distance12                                                                          NaN   
         Maximum edit distance13                                                                          NaN   
         Maximum edit distance14                                                                          NaN   
         Maximum edit distance15                                                                          NaN   
         Maximum edit distance16                                                                          NaN   
         Maximum edit distance17                                                                          NaN   
         Maximum AS-path length7                                                                          NaN   
         Maximum AS-path length8                                                                          NaN   
         Maximum AS-path length9                                                                          NaN   
         Maximum AS-path length10                                                                         NaN   
         Maximum AS-path length11                                                                         NaN   
         Maximum AS-path length12                                                                         NaN   
         Maximum AS-path length13                                                                         NaN   
         Maximum AS-path length14                                                                         NaN   
         Maximum AS-path length15                                                                         NaN   
         Number of Interior Gateway Protocol (IGP) packets                                                NaN   
         Number of Exterior Gateway Protocol (EGP) packets                                                1.0   
         Number of incomplete packets                                                                     NaN   
         Packet size (B)                                                                                  NaN   
         Label                                                                                            NaN   
         
                                                            Number of incomplete packets  \textbackslash{}
         Hour and Minutes                                                            NaN   
         Hour                                                                        NaN   
         Minutes                                                                     NaN   
         Seconds                                                                     NaN   
         Number of announcements                                                0.973340   
         Number of withdrawals                                                       NaN   
         Number of announced NLRI prefixes                                      0.963797   
         Number of withdrawn NLRI prefixes                                           NaN   
         Average AS-path length                                                      NaN   
         Maximum AS-path length                                                      NaN   
         Average unique AS-path length                                               NaN   
         Number of duplicate announcements                                           NaN   
         Number of duplicate withdrawals                                             NaN   
         Number of implicit withdrawals                                              NaN   
         Average edit distance                                                       NaN   
         Maximum edit distance                                                       NaN   
         Inter-arrival time                                                          NaN   
         Maximum edit distance7                                                      NaN   
         Maximum edit distance8                                                      NaN   
         Maximum edit distance9                                                      NaN   
         Maximum edit distance10                                                     NaN   
         Maximum edit distance11                                                     NaN   
         Maximum edit distance12                                                     NaN   
         Maximum edit distance13                                                     NaN   
         Maximum edit distance14                                                     NaN   
         Maximum edit distance15                                                     NaN   
         Maximum edit distance16                                                     NaN   
         Maximum edit distance17                                                     NaN   
         Maximum AS-path length7                                                     NaN   
         Maximum AS-path length8                                                     NaN   
         Maximum AS-path length9                                                     NaN   
         Maximum AS-path length10                                                    NaN   
         Maximum AS-path length11                                                    NaN   
         Maximum AS-path length12                                                    NaN   
         Maximum AS-path length13                                                    NaN   
         Maximum AS-path length14                                                    NaN   
         Maximum AS-path length15                                                    NaN   
         Number of Interior Gateway Protocol (IGP) packets                      0.968771   
         Number of Exterior Gateway Protocol (EGP) packets                           NaN   
         Number of incomplete packets                                           1.000000   
         Packet size (B)                                                             NaN   
         Label                                                                       NaN   
         
                                                            Packet size (B)  Label  
         Hour and Minutes                                               NaN    NaN  
         Hour                                                           NaN    NaN  
         Minutes                                                        NaN    NaN  
         Seconds                                                        NaN    NaN  
         Number of announcements                                        NaN    NaN  
         Number of withdrawals                                          NaN    NaN  
         Number of announced NLRI prefixes                              NaN    NaN  
         Number of withdrawn NLRI prefixes                              NaN    NaN  
         Average AS-path length                                         NaN    NaN  
         Maximum AS-path length                                         NaN    NaN  
         Average unique AS-path length                                  NaN    NaN  
         Number of duplicate announcements                              NaN    NaN  
         Number of duplicate withdrawals                                NaN    NaN  
         Number of implicit withdrawals                                 NaN    NaN  
         Average edit distance                                          NaN    NaN  
         Maximum edit distance                                          NaN    NaN  
         Inter-arrival time                                             NaN    NaN  
         Maximum edit distance7                                         NaN    NaN  
         Maximum edit distance8                                         NaN    NaN  
         Maximum edit distance9                                         NaN    NaN  
         Maximum edit distance10                                        NaN    NaN  
         Maximum edit distance11                                        NaN    NaN  
         Maximum edit distance12                                        NaN    NaN  
         Maximum edit distance13                                        NaN    NaN  
         Maximum edit distance14                                        NaN    NaN  
         Maximum edit distance15                                        NaN    NaN  
         Maximum edit distance16                                        NaN    NaN  
         Maximum edit distance17                                        NaN    NaN  
         Maximum AS-path length7                                        NaN    NaN  
         Maximum AS-path length8                                        NaN    NaN  
         Maximum AS-path length9                                        NaN    NaN  
         Maximum AS-path length10                                       NaN    NaN  
         Maximum AS-path length11                                       NaN    NaN  
         Maximum AS-path length12                                       NaN    NaN  
         Maximum AS-path length13                                       NaN    NaN  
         Maximum AS-path length14                                       NaN    NaN  
         Maximum AS-path length15                                       NaN    NaN  
         Number of Interior Gateway Protocol (IGP) packets              NaN    NaN  
         Number of Exterior Gateway Protocol (EGP) packets              NaN    NaN  
         Number of incomplete packets                                   NaN    NaN  
         Packet size (B)                                                1.0    NaN  
         Label                                                          NaN    1.0  
         
         [42 rows x 42 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{c+c1}{\PYZsh{}plot it in a heatmap}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{sns}\PY{o}{.}\PY{n}{heatmap}\PY{p}{(}\PY{n}{corr\PYZus{}greater\PYZus{}than\PYZus{}75}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Reds}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{annot} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_54_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{df\PYZus{}duplicate} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{df}\PY{o}{.}\PY{n}{duplicated}\PY{p}{(}\PY{n}{keep}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{last}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{]}
         \PY{n}{df\PYZus{}duplicate}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:} Empty DataFrame
         Columns: [Hour and Minutes, Hour, Minutes, Seconds, Number of announcements, Number of withdrawals, Number of announced NLRI prefixes, Number of withdrawn NLRI prefixes, Average AS-path length, Maximum AS-path length, Average unique AS-path length, Number of duplicate announcements, Number of duplicate withdrawals, Number of implicit withdrawals, Average edit distance, Maximum edit distance, Inter-arrival time, Maximum edit distance7, Maximum edit distance8, Maximum edit distance9, Maximum edit distance10, Maximum edit distance11, Maximum edit distance12, Maximum edit distance13, Maximum edit distance14, Maximum edit distance15, Maximum edit distance16, Maximum edit distance17, Maximum AS-path length7, Maximum AS-path length8, Maximum AS-path length9, Maximum AS-path length10, Maximum AS-path length11, Maximum AS-path length12, Maximum AS-path length13, Maximum AS-path length14, Maximum AS-path length15, Number of Interior Gateway Protocol (IGP) packets, Number of Exterior Gateway Protocol (EGP) packets, Number of incomplete packets, Packet size (B), Label]
         Index: []
         
         [0 rows x 42 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{df\PYZus{}duplicate}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}47}]:} (0, 42)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{to\PYZus{}drop} \PY{o}{=} \PY{p}{[}\PY{n}{column} \PY{k}{for} \PY{n}{column} \PY{o+ow}{in} \PY{n}{upper\PYZus{}tri}\PY{o}{.}\PY{n}{columns} \PY{k}{if} \PY{n+nb}{any}\PY{p}{(}\PY{n}{upper\PYZus{}tri}\PY{p}{[}\PY{n}{column}\PY{p}{]} \PY{o}{\PYZgt{}} \PY{l+m+mf}{0.90}\PY{p}{)}\PY{p}{]}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{to\PYZus{}drop}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['Hour', 'Number of announced NLRI prefixes', 'Number of withdrawn NLRI prefixes', 'Average edit distance', 'Maximum AS-path length10', 'Maximum AS-path length11', 'Maximum AS-path length12', 'Maximum AS-path length13', 'Maximum AS-path length14', 'Maximum AS-path length15', 'Number of Interior Gateway Protocol (IGP) packets', 'Number of incomplete packets']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{c+c1}{\PYZsh{}deal with missing values}
         
         \PY{k}{for} \PY{n}{column} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
             \PY{n}{df}\PY{p}{[}\PY{n}{column}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{unknown}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n}{df}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n}{df}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{df}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}50}]:}        Hour and Minutes  Hour  Minutes  Seconds  Number of announcements  \textbackslash{}
         0                     1     0        1        4                       40   
         1                     2     0        2        0                       59   
         2                     3     0        3       12                       52   
         3                     4     0        4        9                       49   
         4                     5     0        5        4                       80   
         {\ldots}                 {\ldots}   {\ldots}      {\ldots}      {\ldots}                      {\ldots}   
         17242              2355    23       55       12                       41   
         17243              2356    23       56        5                       31   
         17244              2357    23       57        0                       44   
         17245              2358    23       58        4                       65   
         17246              2359    23       59       14                       57   
         
                Number of withdrawals  Number of announced NLRI prefixes  \textbackslash{}
         0                          4                                161   
         1                          7                                133   
         2                          4                                138   
         3                          2                                119   
         4                          3                                231   
         {\ldots}                      {\ldots}                                {\ldots}   
         17242                      5                                202   
         17243                      3                                286   
         17244                      6                                 96   
         17245                      4                                170   
         17246                      6                                 89   
         
                Number of withdrawn NLRI prefixes  Average AS-path length  \textbackslash{}
         0                                     28                       6   
         1                                     69                       6   
         2                                     32                       5   
         3                                     24                       6   
         4                                     26                       7   
         {\ldots}                                  {\ldots}                     {\ldots}   
         17242                                 31                       5   
         17243                                  5                       6   
         17244                                 42                       6   
         17245                                 24                       6   
         17246                                 24                       6   
         
                Maximum AS-path length  {\ldots}  Maximum AS-path length11  \textbackslash{}
         0                           8  {\ldots}                         0   
         1                          13  {\ldots}                         0   
         2                           7  {\ldots}                         0   
         3                           9  {\ldots}                         0   
         4                          11  {\ldots}                         0   
         {\ldots}                       {\ldots}  {\ldots}                       {\ldots}   
         17242                      10  {\ldots}                         0   
         17243                       7  {\ldots}                         0   
         17244                       8  {\ldots}                         0   
         17245                       9  {\ldots}                         0   
         17246                       9  {\ldots}                         0   
         
                Maximum AS-path length12  Maximum AS-path length13  \textbackslash{}
         0                             0                         0   
         1                             1                         0   
         2                             0                         0   
         3                             0                         0   
         4                             0                         0   
         {\ldots}                         {\ldots}                       {\ldots}   
         17242                         0                         0   
         17243                         0                         0   
         17244                         0                         0   
         17245                         0                         0   
         17246                         0                         0   
         
                Maximum AS-path length14  Maximum AS-path length15  \textbackslash{}
         0                             0                         0   
         1                             0                         0   
         2                             0                         0   
         3                             0                         0   
         4                             0                         0   
         {\ldots}                         {\ldots}                       {\ldots}   
         17242                         0                         0   
         17243                         0                         0   
         17244                         0                         0   
         17245                         0                         0   
         17246                         0                         0   
         
                Number of Interior Gateway Protocol (IGP) packets  \textbackslash{}
         0                                                     34   
         1                                                     55   
         2                                                     48   
         3                                                     46   
         4                                                     76   
         {\ldots}                                                  {\ldots}   
         17242                                                 40   
         17243                                                 31   
         17244                                                 41   
         17245                                                 58   
         17246                                                 54   
         
                Number of Exterior Gateway Protocol (EGP) packets  \textbackslash{}
         0                                                      0   
         1                                                      0   
         2                                                      0   
         3                                                      0   
         4                                                      0   
         {\ldots}                                                  {\ldots}   
         17242                                                  0   
         17243                                                  0   
         17244                                                  0   
         17245                                                  0   
         17246                                                  0   
         
                Number of incomplete packets  Packet size (B)  Label  
         0                                 6              287     -1  
         1                                 4              256     -1  
         2                                 4              263     -1  
         3                                 3              252     -1  
         4                                 4              270     -1  
         {\ldots}                             {\ldots}              {\ldots}    {\ldots}  
         17242                             1              303     -1  
         17243                             0              348     -1  
         17244                             3              247     -1  
         17245                             7              255     -1  
         17246                             3              223     -1  
         
         [17247 rows x 42 columns]
\end{Verbatim}
            
    \subsubsection{Step 3: Preparing for Machine Learning: Train/Test
Split}\label{step-3-preparing-for-machine-learning-traintest-split}

With the data prepared, split it into a train and test set.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{X} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{y} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{X\PYZus{}train}\PY{p}{,}\PY{n}{X\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}train}\PY{p}{,}\PY{n}{y\PYZus{}test} \PY{o}{=} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{y}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{X\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}53}]:} ((12935, 41), (12935,), (4312, 41), (4312,))
\end{Verbatim}
            
    \subsubsection{Step 4: Scaling the dataset for Machine Learning
Algorithms}\label{step-4-scaling-the-dataset-for-machine-learning-algorithms}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{n}{sc} \PY{o}{=} \PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}
         \PY{n}{sc}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}54}]:} array([[-0.2206487 , -0.21705711, -0.14612511, {\ldots}, -0.14710669,
                 -0.15213287, -0.11525763],
                [ 1.04394235,  1.08404497, -1.59064723, {\ldots}, -0.14710669,
                 -0.23683485, -0.45032193],
                [-1.39274395, -1.37359229, -0.78171484, {\ldots}, -0.14710669,
                 -0.27918584,  0.46552049],
                {\ldots},
                [ 0.82571007,  0.79491117,  1.24061613, {\ldots}, -0.14710669,
                 -0.44858979, -0.69603574],
                [ 0.34877858,  0.36121048, -0.49281042, {\ldots}, -0.14710669,
                 -0.4062388 , -0.80772384],
                [ 1.68852248,  1.66231256,  1.06727347, {\ldots}, -0.14710669,
                 -0.19448386, -0.67369812]])
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{c+c1}{\PYZsh{} MinMaxScaler Object}
         \PY{n}{scaler} \PY{o}{=} \PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{scaler}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}55}]:} array([[4.35353964e-01, 4.34782609e-01, 4.57627119e-01, {\ldots},
                 0.00000000e+00, 4.82758621e-03, 2.65151515e-02],
                [8.06273845e-01, 8.26086957e-01, 3.38983051e-02, {\ldots},
                 0.00000000e+00, 3.44827586e-03, 2.02020202e-02],
                [9.15642221e-02, 8.69565217e-02, 2.71186441e-01, {\ldots},
                 0.00000000e+00, 2.75862069e-03, 3.74579125e-02],
                {\ldots},
                [7.42263671e-01, 7.39130435e-01, 8.64406780e-01, {\ldots},
                 0.00000000e+00, 0.00000000e+00, 1.55723906e-02],
                [6.02373887e-01, 6.08695652e-01, 3.55932203e-01, {\ldots},
                 0.00000000e+00, 6.89655172e-04, 1.34680135e-02],
                [9.95337007e-01, 1.00000000e+00, 8.13559322e-01, {\ldots},
                 0.00000000e+00, 4.13793103e-03, 1.59932660e-02]])
\end{Verbatim}
            
    \subsubsection{Step 5: A Baseline Model}\label{step-5-a-baseline-model}

Before we build our first model, we want to establish a baseline. What
is the baseline performance that our classifier should aim to beat?

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{c+c1}{\PYZsh{} Predict values and probability of training and testing data}
         \PY{k}{def} \PY{n+nf}{prediction\PYZus{}model}\PY{p}{(}\PY{n}{model}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{:}
             \PY{n}{y\PYZus{}train\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}
             \PY{n}{y\PYZus{}train\PYZus{}pred\PYZus{}prob} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
             \PY{n}{y\PYZus{}test\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
             \PY{n}{y\PYZus{}test\PYZus{}pred\PYZus{}prob} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
             \PY{k}{return} \PY{n}{y\PYZus{}train\PYZus{}pred}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}pred\PYZus{}prob}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}pred}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}pred\PYZus{}prob}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{c+c1}{\PYZsh{} Method to draw ROC curve from training and test data probability}
         \PY{k}{def} \PY{n+nf}{draw\PYZus{}roc}\PY{p}{(} \PY{n}{train\PYZus{}actual}\PY{p}{,} \PY{n}{train\PYZus{}probs}\PY{p}{,} \PY{n}{test\PYZus{}actual}\PY{p}{,} \PY{n}{test\PYZus{}probs} \PY{p}{)}\PY{p}{:}
             \PY{n}{train\PYZus{}fpr}\PY{p}{,} \PY{n}{train\PYZus{}tpr}\PY{p}{,} \PY{n}{train\PYZus{}thresholds} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{roc\PYZus{}curve}\PY{p}{(} \PY{n}{train\PYZus{}actual}\PY{p}{,} \PY{n}{train\PYZus{}probs}\PY{p}{,}
                                                       \PY{n}{drop\PYZus{}intermediate} \PY{o}{=} \PY{k+kc}{False} \PY{p}{)}
             \PY{n}{test\PYZus{}fpr}\PY{p}{,} \PY{n}{test\PYZus{}tpr}\PY{p}{,} \PY{n}{test\PYZus{}thresholds} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{roc\PYZus{}curve}\PY{p}{(} \PY{n}{test\PYZus{}actual}\PY{p}{,} \PY{n}{test\PYZus{}probs}\PY{p}{,}
                                                       \PY{n}{drop\PYZus{}intermediate} \PY{o}{=} \PY{k+kc}{False} \PY{p}{)}
             \PY{n}{train\PYZus{}auc\PYZus{}score} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(} \PY{n}{train\PYZus{}actual}\PY{p}{,} \PY{n}{train\PYZus{}probs} \PY{p}{)}
             \PY{n}{test\PYZus{}auc\PYZus{}score} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(} \PY{n}{test\PYZus{}actual}\PY{p}{,} \PY{n}{test\PYZus{}probs} \PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(} \PY{n}{train\PYZus{}fpr}\PY{p}{,} \PY{n}{train\PYZus{}tpr}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ROC curve (area = }\PY{l+s+si}{\PYZpc{}0.2f}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{train\PYZus{}auc\PYZus{}score} \PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(} \PY{n}{test\PYZus{}fpr}\PY{p}{,} \PY{n}{test\PYZus{}tpr}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ROC curve (area = }\PY{l+s+si}{\PYZpc{}0.2f}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{test\PYZus{}auc\PYZus{}score} \PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{1.05}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate or [1 \PYZhy{} True Negative Rate]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Receiver operating characteristic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower right}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
         
             \PY{k}{return} \PY{k+kc}{None}
\end{Verbatim}


    \subsubsection{Step 6: A Simple Model}\label{step-6-a-simple-model}

Use Logistic Regression to build a basic model on your data.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{logreg} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{solver}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lbfgs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{random\PYZus{}state} \PY{o}{=} \PY{l+m+mi}{100}\PY{p}{)}
         \PY{n}{logreg} \PY{o}{=} \PY{n}{logreg}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{y\PYZus{}train\PYZus{}pred}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}pred\PYZus{}prob}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}pred}\PY{p}{,}\PY{n}{y\PYZus{}test\PYZus{}pred\PYZus{}prob}\PY{o}{=} \PY{n}{prediction\PYZus{}model}\PY{p}{(}\PY{n}{logreg}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Step 7: Score the Model}\label{step-7-score-the-model}

What is the accuracy of our model?

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n}{draw\PYZus{}roc}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}pred\PYZus{}prob}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}pred\PYZus{}prob}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_74_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy train: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}pred}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy test: }\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}pred}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy train:  0.8215693853884809
Accuracy test:  0.823051948051948

    \end{Verbatim}

    \subsubsection{Step 8: Model
Comparisons}\label{step-8-model-comparisons}

Now, we aim to compare the performance of the Logistic Regression model
to KNN , Decision Tree, and SVM algorithm based models. Using the
default settings for each of the models, fit and score each. We are
comparing the fit time of each of the models. We will present our
findings in a \texttt{DataFrame} similar to the one below:

\begin{longtable}[]{@{}llll@{}}
\toprule
Model & Train Time & Train Accuracy & Test Accuracy\tabularnewline
\midrule
\endhead
& & . & .\tabularnewline
\bottomrule
\end{longtable}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{k}{def} \PY{n+nf}{model\PYZus{}report}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{n}{model}\PY{p}{)}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Search for OPTIMAL THRESHOLD, vary from 0.0001 to 0.9999, fit/predict on train/test data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
             \PY{n}{optimal\PYZus{}th} \PY{o}{=} \PY{l+m+mf}{0.5}   \PY{c+c1}{\PYZsh{} start with default threshold value}
             
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{:}
                 \PY{n}{score\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
                 \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Looping decimal place}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)} 
                 \PY{n}{th\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{optimal\PYZus{}th}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.4999}\PY{p}{,} \PY{n}{optimal\PYZus{}th}\PY{o}{+}\PY{l+m+mf}{0.4999}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{)}\PY{p}{,} 
                           \PY{c+c1}{\PYZsh{} eg [ 0.0001 , 0.1008, 0.2006, 0.3004, 0.4002, 0.5, 0.5998, 0.6996, 0.7994, 0.8992, 0.9999 ]}
                          \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{optimal\PYZus{}th}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{optimal\PYZus{}th}\PY{o}{+}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{)}\PY{p}{,} 
                           \PY{c+c1}{\PYZsh{} eg 0.3xx [ 0.2 , 0.21, 0.22, 0.23, 0.24, 0.25, 0.26, 0.27, 0.28, 0.29, 0.3 , 0.31, 0.32, 0.33, 0.34, 0.35, 0.36, 0.37, 0.38, 0.39, 0.4 ]}
                          \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{n}{optimal\PYZus{}th}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{n}{optimal\PYZus{}th}\PY{o}{+}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{)}\PY{p}{]}
                           \PY{c+c1}{\PYZsh{} eg 0.30x [ 0.29 , 0.291, 0.292, 0.293, 0.294, 0.295, 0.296, 0.297, 0.298, 0.299, 0.3  , 0.301, 0.302, 0.303, 0.304, 0.305, 0.306, 0.307, 0.308, 0.309, 0.31 ]}
                 \PY{k}{for} \PY{n}{th} \PY{o+ow}{in} \PY{n}{th\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{:}
                     \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{th}\PY{p}{)}
                     \PY{n}{f1scor} \PY{o}{=} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                     \PY{n}{score\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{f1scor}\PY{p}{)}
                     \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.3f\PYZcb{}}\PY{l+s+s1}{\PYZhy{}\PYZgt{}}\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{th}\PY{p}{,} \PY{n}{f1scor}\PY{p}{)}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,  }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}   \PY{c+c1}{\PYZsh{} display score in 4 decimal pl}
                 \PY{n}{optimal\PYZus{}th} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{th\PYZus{}list}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{[}\PY{n}{score\PYZus{}list}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{score\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{optimal F1 score = }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{score\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{optimal threshold = }\PY{l+s+si}{\PYZob{}:.3f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{optimal\PYZus{}th}\PY{p}{)}\PY{p}{)}
         
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{accuracy score is}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training: }\PY{l+s+si}{\PYZob{}:.2f\PYZcb{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{l+m+mi}{100}\PY{o}{*}\PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}\PY{p}{)}  \PY{c+c1}{\PYZsh{} score uses accuracy}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test set: }\PY{l+s+si}{\PYZob{}:.2f\PYZcb{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{l+m+mi}{100}\PY{o}{*}\PY{n}{model}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}\PY{p}{)}   \PY{c+c1}{\PYZsh{} should use cross validation}
         
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Adjust threshold to 0.25:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Precision: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{,   Recall: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{,   F1 Score: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                 \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{confusion matrix: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
         
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Default threshold of 0.50:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Precision: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{,   Recall: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{,   F1 Score: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                 \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{confusion matrix: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
         
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mf}{0.75}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Adjust threshold to 0.75:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Precision: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{,   Recall: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{,   F1 Score: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                 \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{confusion matrix: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
         
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{p}{(}\PY{n}{model}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{n}{optimal\PYZus{}th}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Optimal threshold }\PY{l+s+si}{\PYZob{}:.3f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{optimal\PYZus{}th}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Precision: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{,   Recall: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{,   F1 Score: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}
                 \PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{,} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{confusion matrix: }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
             
             \PY{k}{global} \PY{n}{model\PYZus{}f1}\PY{p}{,} \PY{n}{model\PYZus{}auc}\PY{p}{,} \PY{n}{model\PYZus{}ll}\PY{p}{,} \PY{n}{model\PYZus{}roc\PYZus{}auc}
             \PY{n}{model\PYZus{}f1} \PY{o}{=} \PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{,} \PY{n}{average}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{weighted}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
             \PY{n}{model\PYZus{}ll} \PY{o}{=} \PY{n}{log\PYZus{}loss}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Log\PYZhy{}loss: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{model\PYZus{}ll}\PY{p}{)}\PY{p}{)}
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
             \PY{n}{model\PYZus{}roc\PYZus{}auc} \PY{o}{=} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{roc\PYZus{}auc\PYZus{}score: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{model\PYZus{}roc\PYZus{}auc}\PY{p}{)}\PY{p}{)} 
             \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{model}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
             \PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
             \PY{n}{model\PYZus{}auc} \PY{o}{=} \PY{n}{auc}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{model\PYZus{}name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AUC: }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{model\PYZus{}auc}\PY{p}{)}\PY{p}{)}
         
             \PY{c+c1}{\PYZsh{} plot the ROC curve}
             \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ROC curve (area = }\PY{l+s+si}{\PYZpc{}0.2f}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{model\PYZus{}auc}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Receiver Operating Characteristic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{lower right}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} plt.savefig(\PYZsq{}roc\PYZus{}auc\PYZus{}score\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
           
             \PY{k}{return}
         
         \PY{c+c1}{\PYZsh{} initialise lists to collect the results to plot later}
         \PY{n}{model\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{f1\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{auc\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{ll\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{roc\PYZus{}auc\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{time\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{train\PYZus{}score}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         \PY{n}{test\PYZus{}score}\PY{o}{=}\PY{p}{[}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{ SVC }\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{time1} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}
         \PY{n}{svc} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{gamma}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{probability}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{model\PYZus{}report}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SVC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{svc}\PY{p}{)}
         
         \PY{n}{model\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SVC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{f1\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}f1}\PY{p}{)}
         \PY{n}{auc\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}auc}\PY{p}{)}
         \PY{n}{ll\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}ll}\PY{p}{)}
         \PY{n}{roc\PYZus{}auc\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}roc\PYZus{}auc}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} actual time spent, or}
         \PY{n}{train\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{svc}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}
         \PY{n}{test\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{svc}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
         \PY{n}{time\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{time1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

"""""" SVC """"""

Search for OPTIMAL THRESHOLD, vary from 0.0001 to 0.9999, fit/predict on train/test data

Looping decimal place 1
0.000->0.1032,  0.100->0.1534,  0.200->0.1779,  0.300->0.1757,  0.400->0.1680,  0.500->0.1575,  0.600->0.1466,  0.700->0.1369,  0.800->0.1239,  0.900->0.1053,  1.000->0.0118,  
Looping decimal place 2
0.100->0.1534,  0.110->0.1591,  0.120->0.1632,  0.130->0.1666,  0.140->0.1694,  0.150->0.1725,  0.160->0.1732,  0.170->0.1745,  0.180->0.1759,  0.190->0.1770,  0.200->0.1779,  0.210->0.1790,  0.220->0.1788,  0.230->0.1784,  0.240->0.1786,  0.250->0.1794,  0.260->0.1790,  0.270->0.1789,  0.280->0.1783,  0.290->0.1774,  0.300->0.1757,  
Looping decimal place 3
0.240->0.1786,  0.241->0.1786,  0.242->0.1789,  0.243->0.1789,  0.244->0.1792,  0.245->0.1791,  0.246->0.1789,  0.247->0.1790,  0.248->0.1792,  0.249->0.1791,  0.250->0.1794,  0.251->0.1796,  0.252->0.1795,  0.253->0.1797,  0.254->0.1796,  0.255->0.1797,  0.256->0.1795,  0.257->0.1794,  0.258->0.1789,  0.259->0.1790,  0.260->0.1790,  optimal F1 score = 0.1797
optimal threshold = 0.253
SVC accuracy score is
Training: 83.42\%
Test set: 82.95\%

Adjust threshold to 0.25:
Precision: 0.1664,   Recall: 0.1946,   F1 Score: 0.1794
SVC confusion matrix: 
 [[   0 2771  444]
 [   0    0    0]
 [   0  258  839]]

Default threshold of 0.50:
Precision: 0.8238,   Recall: 0.8295,   F1 Score: 0.8127
SVC confusion matrix: 
 [[3077  138]
 [ 597  500]]

Adjust threshold to 0.75:
Precision: 0.2090,   Recall: 0.0951,   F1 Score: 0.1307
SVC confusion matrix: 
 [[   0 3126   89]
 [   0    0    0]
 [   0  687  410]]

Optimal threshold 0.253
Precision: 0.1673,   Recall: 0.1941,   F1 Score: 0.1797
SVC confusion matrix: 
 [[   0 2779  436]
 [   0    0    0]
 [   0  260  837]]
SVC Log-loss: 0.3612
SVC roc\_auc\_score: 0.7064
SVC AUC: 0.9059

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_78_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{ LogisticRegression }\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Search for optimal hyperparameter C in LogisticRegresssion, vary C from 0.001 to 1000, using KFold(5) Cross Validation on train data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{kf} \PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{21}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}  \PY{c+c1}{\PYZsh{} k folds}
         \PY{n}{score\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{c\PYZus{}list} \PY{o}{=} \PY{l+m+mi}{10}\PY{o}{*}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{200}\PY{p}{)}
         \PY{k}{for} \PY{n}{c} \PY{o+ow}{in} \PY{n}{c\PYZus{}list}\PY{p}{:}
             \PY{n}{logit} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{C} \PY{o}{=} \PY{n}{c}\PY{p}{)}
             \PY{n}{cvs} \PY{o}{=} \PY{p}{(}\PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{(}\PY{n}{logit}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{kf}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
             \PY{n}{score\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{cvs}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{cvs}\PY{p}{)}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}   \PY{c+c1}{\PYZsh{} 4 decimal pl}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{optimal cv F1 score = }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{score\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{optimal\PYZus{}c} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{c\PYZus{}list}\PY{p}{[}\PY{n}{score\PYZus{}list}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{score\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{optimal value of C = }\PY{l+s+si}{\PYZob{}:.3f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{optimal\PYZus{}c}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{time1} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}
         \PY{n}{logit} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{C} \PY{o}{=} \PY{n}{optimal\PYZus{}c}\PY{p}{)}
         \PY{n}{model\PYZus{}report}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LogisticRegression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{logit}\PY{p}{)}
         
         \PY{n}{model\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LogisticRegression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{f1\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}f1}\PY{p}{)}
         \PY{n}{auc\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}auc}\PY{p}{)}
         \PY{n}{ll\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}ll}\PY{p}{)}
         \PY{n}{roc\PYZus{}auc\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}roc\PYZus{}auc}\PY{p}{)}
         \PY{n}{train\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}
         \PY{n}{test\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{logreg}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
         \PY{n}{time\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{time1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

"""""" LogisticRegression """"""

Search for optimal hyperparameter C in LogisticRegresssion, vary C from 0.001 to 1000, using KFold(5) Cross Validation on train data
0.5442, 0.5480, 0.5451, 0.5485, 0.5458, 0.5467, 0.5445, 0.5444, 0.5431, 0.5464, 0.5467, 0.5479, 0.5440, 0.5466, 0.5487, 0.5423, 0.5476, 0.5458, 0.5515, 0.5473, 0.5448, 0.5454, 0.5454, 0.5467, 0.5454, 0.5455, 0.5441, 0.5479, 0.5432, 0.5460, 0.5433, 0.5445, 0.5465, 0.5475, 0.5472, 0.5461, 0.5459, 0.5468, 0.5479, 0.5449, 0.5432, 0.5457, 0.5440, 0.5489, 0.5449, 0.5443, 0.5478, 0.5454, 0.5453, 0.5475, 0.5455, 0.5493, 0.5476, 0.5441, 0.5440, 0.5454, 0.5458, 0.5453, 0.5476, 0.5460, 0.5440, 0.5465, 0.5485, 0.5457, 0.5458, 0.5463, 0.5470, 0.5467, 0.5481, 0.5457, 0.5447, 0.5428, 0.5427, 0.5458, 0.5464, 0.5448, 0.5464, 0.5469, 0.5467, 0.5483, 0.5463, 0.5461, 0.5440, 0.5491, 0.5463, 0.5461, 0.5447, 0.5474, 0.5485, 0.5453, 0.5474, 0.5461, 0.5463, 0.5490, 0.5447, 0.5449, 0.5461, 0.5439, 0.5437, 0.5480, 0.5483, 0.5453, 0.5460, 0.5462, 0.5458, 0.5459, 0.5431, 0.5425, 0.5437, 0.5440, 0.5452, 0.5429, 0.5466, 0.5451, 0.5464, 0.5413, 0.5456, 0.5479, 0.5458, 0.5474, 0.5456, 0.5480, 0.5455, 0.5468, 0.5466, 0.5463, 0.5491, 0.5448, 0.5466, 0.5470, 0.5428, 0.5458, 0.5460, 0.5458, 0.5453, 0.5460, 0.5451, 0.5433, 0.5474, 0.5450, 0.5491, 0.5469, 0.5446, 0.5429, 0.5440, 0.5462, 0.5475, 0.5475, 0.5440, 0.5469, 0.5470, 0.5448, 0.5468, 0.5487, 0.5477, 0.5441, 0.5476, 0.5494, 0.5457, 0.5445, 0.5481, 0.5486, 0.5478, 0.5467, 0.5458, 0.5467, 0.5470, 0.5467, 0.5454, 0.5470, 0.5452, 0.5450, 0.5432, 0.5476, 0.5465, 0.5471, 0.5464, 0.5501, 0.5495, 0.5442, 0.5458, 0.5467, 0.5463, 0.5483, 0.5465, 0.5456, 0.5424, 0.5492, 0.5470, 0.5461, 0.5422, 0.5485, 0.5474, 0.5475, 0.5469, 0.5463, 0.5429, 0.5499, 0.5458, 0.5455, optimal cv F1 score = 0.5515
optimal value of C = 0.003

Search for OPTIMAL THRESHOLD, vary from 0.0001 to 0.9999, fit/predict on train/test data

Looping decimal place 1
0.000->0.1032,  0.100->0.1227,  0.200->0.1586,  0.300->0.1633,  0.400->0.1542,  0.500->0.1390,  0.600->0.1230,  0.700->0.1066,  0.800->0.0899,  0.900->0.0672,  1.000->0.0148,  
Looping decimal place 2
0.200->0.1586,  0.210->0.1605,  0.220->0.1607,  0.230->0.1622,  0.240->0.1634,  0.250->0.1636,  0.260->0.1637,  0.270->0.1639,  0.280->0.1645,  0.290->0.1647,  0.300->0.1633,  0.310->0.1644,  0.320->0.1637,  0.330->0.1624,  0.340->0.1618,  0.350->0.1612,  0.360->0.1591,  0.370->0.1573,  0.380->0.1577,  0.390->0.1567,  0.400->0.1542,  
Looping decimal place 3
0.280->0.1645,  0.281->0.1645,  0.282->0.1648,  0.283->0.1644,  0.284->0.1646,  0.285->0.1649,  0.286->0.1648,  0.287->0.1651,  0.288->0.1649,  0.289->0.1649,  0.290->0.1647,  0.291->0.1644,  0.292->0.1637,  0.293->0.1634,  0.294->0.1633,  0.295->0.1632,  0.296->0.1635,  0.297->0.1637,  0.298->0.1635,  0.299->0.1634,  0.300->0.1633,  optimal F1 score = 0.1651
optimal threshold = 0.287
LogisticRegression accuracy score is
Training: 82.14\%
Test set: 82.26\%

Adjust threshold to 0.25:
Precision: 0.1467,   Recall: 0.1848,   F1 Score: 0.1636
LogisticRegression confusion matrix: 
 [[   0 2630  585]
 [   0    0    0]
 [   0  300  797]]

Default threshold of 0.50:
Precision: 0.8170,   Recall: 0.8226,   F1 Score: 0.8024
LogisticRegression confusion matrix: 
 [[3086  129]
 [ 636  461]]

Adjust threshold to 0.75:
Precision: 0.2187,   Recall: 0.0640,   F1 Score: 0.0990
LogisticRegression confusion matrix: 
 [[   0 3170   45]
 [   0    0    0]
 [   0  821  276]]

Optimal threshold 0.287
Precision: 0.1592,   Recall: 0.1714,   F1 Score: 0.1651
LogisticRegression confusion matrix: 
 [[   0 2773  442]
 [   0    0    0]
 [   0  358  739]]
LogisticRegression Log-loss: 0.4624
LogisticRegression roc\_auc\_score: 0.6901
LogisticRegression AUC: 0.8495

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_79_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{ KNN }\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Search for optimal hyperparameter K in KNN, vary K from 1 to 20, using KFold(5) Cross Validation on train data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{kf} \PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{21}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}  \PY{c+c1}{\PYZsh{}produce the k folds}
         \PY{n}{k\PYZus{}scores} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{)}\PY{p}{:}
             \PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsClassifier}\PY{p}{(}\PY{n}{n\PYZus{}neighbors} \PY{o}{=} \PY{n}{k}\PY{p}{)}
             \PY{n}{cvs} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{(}\PY{n}{knn}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{kf}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
             \PY{n}{k\PYZus{}scores}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{cvs}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{cvs}\PY{p}{)}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{optimal cv F1 score = }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{k\PYZus{}scores}\PY{p}{)}\PY{p}{)}\PY{p}{)}   \PY{c+c1}{\PYZsh{} 4 decimal pl}
         \PY{n}{optimal\PYZus{}k} \PY{o}{=} \PY{n}{k\PYZus{}scores}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{k\PYZus{}scores}\PY{p}{)}\PY{p}{)}\PY{o}{+}\PY{l+m+mi}{1}   \PY{c+c1}{\PYZsh{} index 0 is for k=1}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{optimal value of K =}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{optimal\PYZus{}k}\PY{p}{)}
         
         \PY{n}{time1} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}
         \PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsClassifier}\PY{p}{(}\PY{n}{n\PYZus{}neighbors} \PY{o}{=} \PY{n}{optimal\PYZus{}k}\PY{p}{)}
         \PY{n}{model\PYZus{}report}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KNN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{knn}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Compare with KNN classification\PYZus{}report (same as default threshold 0.50)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
         \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{model\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KNN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{f1\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}f1}\PY{p}{)}
         \PY{n}{auc\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}auc}\PY{p}{)}
         \PY{n}{ll\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}ll}\PY{p}{)}
         \PY{n}{roc\PYZus{}auc\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}roc\PYZus{}auc}\PY{p}{)}
         \PY{n}{train\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{knn}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}
         \PY{n}{test\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{knn}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
         \PY{n}{time\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{time1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

"""""" KNN """"""

Search for optimal hyperparameter K in KNN, vary K from 1 to 20, using KFold(5) Cross Validation on train data
0.6350, 0.5947, 0.6624, 0.6263, 0.6670, 0.6464, 0.6665, 0.6493, 0.6688, 0.6546, 0.6704, 0.6508, 0.6668, 0.6533, 0.6625, 0.6516, 0.6615, 0.6514, 0.6620, 0.6515, optimal cv F1 score = 0.6704
optimal value of K = 11

Search for OPTIMAL THRESHOLD, vary from 0.0001 to 0.9999, fit/predict on train/test data

Looping decimal place 1
0.000->0.1441,  0.100->0.1600,  0.200->0.1706,  0.300->0.1736,  0.400->0.1739,  0.500->0.1730,  0.600->0.1643,  0.700->0.1504,  0.800->0.1348,  0.900->0.1128,  1.000->0.0791,  
Looping decimal place 2
0.300->0.1736,  0.310->0.1736,  0.320->0.1736,  0.330->0.1736,  0.340->0.1736,  0.350->0.1736,  0.360->0.1736,  0.370->0.1739,  0.380->0.1739,  0.390->0.1739,  0.400->0.1739,  0.410->0.1739,  0.420->0.1739,  0.430->0.1739,  0.440->0.1739,  0.450->0.1739,  0.460->0.1730,  0.470->0.1730,  0.480->0.1730,  0.490->0.1730,  0.500->0.1730,  
Looping decimal place 3
0.360->0.1736,  0.361->0.1736,  0.362->0.1736,  0.363->0.1736,  0.364->0.1739,  0.365->0.1739,  0.366->0.1739,  0.367->0.1739,  0.368->0.1739,  0.369->0.1739,  0.370->0.1739,  0.371->0.1739,  0.372->0.1739,  0.373->0.1739,  0.374->0.1739,  0.375->0.1739,  0.376->0.1739,  0.377->0.1739,  0.378->0.1739,  0.379->0.1739,  0.380->0.1739,  optimal F1 score = 0.1739
optimal threshold = 0.364
KNN accuracy score is
Training: 87.08\%
Test set: 84.60\%

Adjust threshold to 0.25:
Precision: 0.1356,   Recall: 0.2301,   F1 Score: 0.1706
KNN confusion matrix: 
 [[   0 2346  869]
 [   0    0    0]
 [   0  105  992]]

Default threshold of 0.50:
Precision: 0.8416,   Recall: 0.8460,   F1 Score: 0.8430
KNN confusion matrix: 
 [[2942  273]
 [ 391  706]]

Adjust threshold to 0.75:
Precision: 0.2289,   Recall: 0.0955,   F1 Score: 0.1348
KNN confusion matrix: 
 [[   0 3169   46]
 [   0    0    0]
 [   0  685  412]]

Optimal threshold 0.364
Precision: 0.1662,   Recall: 0.1823,   F1 Score: 0.1739
KNN confusion matrix: 
 [[   0 2798  417]
 [   0    0    0]
 [   0  311  786]]
KNN Log-loss: 0.5180
KNN roc\_auc\_score: 0.7793
KNN AUC: 0.8986

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_80_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

Compare with KNN classification\_report (same as default threshold 0.50)
              precision    recall  f1-score   support

          -1       0.88      0.92      0.90      3215
           1       0.72      0.64      0.68      1097

    accuracy                           0.85      4312
   macro avg       0.80      0.78      0.79      4312
weighted avg       0.84      0.85      0.84      4312


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{ RandomForestClassifier }\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Search for optimal n\PYZus{}estimators in RandomForest, vary 100 to 500, using KFold(5) Cross Validation on train data}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{kf} \PY{o}{=} \PY{n}{KFold}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{21}\PY{p}{,} \PY{n}{shuffle}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}  \PY{c+c1}{\PYZsh{}produce the k folds}
         \PY{n}{score\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{n\PYZus{}list} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{k}{for} \PY{n}{n} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{150}\PY{p}{,} \PY{l+m+mi}{200}\PY{p}{,} \PY{l+m+mi}{250}\PY{p}{,} \PY{l+m+mi}{300}\PY{p}{,} \PY{l+m+mi}{350}\PY{p}{,} \PY{l+m+mi}{400}\PY{p}{,} \PY{l+m+mi}{450}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{]}\PY{p}{:}
             \PY{n}{randomforest} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{n}\PY{p}{)}
             \PY{n}{cvs} \PY{o}{=} \PY{p}{(}\PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{(}\PY{n}{randomforest}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{kf}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{p}{)}
             \PY{n}{score\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{cvs}\PY{p}{)}
             \PY{n}{n\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{n}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZob{}:.0f\PYZcb{}}\PY{l+s+s1}{\PYZhy{}\PYZgt{}}\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{n}\PY{p}{,} \PY{n}{cvs}\PY{p}{)}\PY{p}{,} \PY{n}{end}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{, }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}   \PY{c+c1}{\PYZsh{} display score in 4 decimal place}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{optimal F1 score = }\PY{l+s+si}{\PYZob{}:.4f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{score\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{optimal\PYZus{}n} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{n\PYZus{}list}\PY{p}{[}\PY{n}{score\PYZus{}list}\PY{o}{.}\PY{n}{index}\PY{p}{(}\PY{n+nb}{max}\PY{p}{(}\PY{n}{score\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{optimal n\PYZus{}estimators = }\PY{l+s+si}{\PYZob{}:.0f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{optimal\PYZus{}n}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{time1} \PY{o}{=} \PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)}
         \PY{n}{randomforest} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{n}{optimal\PYZus{}n}\PY{p}{)}
         \PY{n}{model\PYZus{}report}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{randomforest}\PY{p}{)}
         
         \PY{n}{model\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForestClassifier}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{f1\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}f1}\PY{p}{)}
         \PY{n}{auc\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}auc}\PY{p}{)}
         \PY{n}{ll\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}ll}\PY{p}{)}
         \PY{n}{roc\PYZus{}auc\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{model\PYZus{}roc\PYZus{}auc}\PY{p}{)}
         \PY{n}{train\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{randomforest}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}\PY{p}{)}
         \PY{n}{test\PYZus{}score}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{randomforest}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}
         \PY{n}{time\PYZus{}list}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{time}\PY{o}{.}\PY{n}{time}\PY{p}{(}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{time1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

"""""" RandomForestClassifier """"""

Search for optimal n\_estimators in RandomForest, vary 100 to 500, using KFold(5) Cross Validation on train data
100->0.7159, 150->0.7206, 200->0.7216, 250->0.7209, 300->0.7190, 350->0.7215, 400->0.7236, 450->0.7238, 500->0.7228, optimal F1 score = 0.7238
optimal n\_estimators = 450

Search for OPTIMAL THRESHOLD, vary from 0.0001 to 0.9999, fit/predict on train/test data

Looping decimal place 1
0.000->0.1097,  0.100->0.1599,  0.200->0.1812,  0.300->0.1881,  0.400->0.1903,  0.500->0.1844,  0.600->0.1721,  0.700->0.1518,  0.800->0.1325,  0.900->0.0992,  1.000->0.0113,  
Looping decimal place 2
0.300->0.1881,  0.310->0.1896,  0.320->0.1902,  0.330->0.1904,  0.340->0.1905,  0.350->0.1906,  0.360->0.1911,  0.370->0.1914,  0.380->0.1909,  0.390->0.1904,  0.400->0.1903,  0.410->0.1898,  0.420->0.1897,  0.430->0.1893,  0.440->0.1887,  0.450->0.1881,  0.460->0.1872,  0.470->0.1857,  0.480->0.1847,  0.490->0.1846,  0.500->0.1846,  
Looping decimal place 3
0.360->0.1911,  0.361->0.1911,  0.362->0.1911,  0.363->0.1915,  0.364->0.1915,  0.365->0.1919,  0.366->0.1919,  0.367->0.1914,  0.368->0.1914,  0.369->0.1914,  0.370->0.1914,  0.371->0.1914,  0.372->0.1914,  0.373->0.1914,  0.374->0.1911,  0.375->0.1911,  0.376->0.1910,  0.377->0.1910,  0.378->0.1909,  0.379->0.1909,  0.380->0.1909,  optimal F1 score = 0.1919
optimal threshold = 0.365
RandomForestClassifier accuracy score is
Training: 100.00\%
Test set: 87.24\%

Adjust threshold to 0.25:
Precision: 0.1584,   Recall: 0.2282,   F1 Score: 0.1870
RandomForestClassifier confusion matrix: 
 [[   0 2619  596]
 [   0    0    0]
 [   0  113  984]]

Default threshold of 0.50:
Precision: 0.8685,   Recall: 0.8724,   F1 Score: 0.8682
RandomForestClassifier confusion matrix: 
 [[3035  180]
 [ 370  727]]

Adjust threshold to 0.75:
Precision: 0.2386,   Recall: 0.1018,   F1 Score: 0.1427
RandomForestClassifier confusion matrix: 
 [[   0 3186   29]
 [   0    0    0]
 [   0  658  439]]

Optimal threshold 0.365
Precision: 0.1827,   Recall: 0.2020,   F1 Score: 0.1919
RandomForestClassifier confusion matrix: 
 [[   0 2873  342]
 [   0    0    0]
 [   0  226  871]]
RandomForestClassifier Log-loss: 0.2793
RandomForestClassifier roc\_auc\_score: 0.8034
RandomForestClassifier AUC: 0.9351

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_81_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{c+c1}{\PYZsh{}Log the model performance data into a dataframe}
         
         \PY{n}{res\PYZus{}dict}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{model\PYZus{}list}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{train time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{time\PYZus{}list}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{train\PYZus{}score}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test Accuracy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{test\PYZus{}score}\PY{p}{\PYZcb{}}
         \PY{n}{results\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{res\PYZus{}dict}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}index}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{model}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}round off the values to nearest 2 decimal places for the results}
         
         \PY{n}{results\PYZus{}df} \PY{o}{=} \PY{n}{results\PYZus{}df}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{n}{decimals} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{results\PYZus{}df}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}67}]:}                         train time  Train Accuracy  Test Accuracy
         model                                                            
         SVC                        1099.20            0.83           0.83
         LogisticRegression            3.18            0.82           0.82
         KNN                         907.30            0.87           0.85
         RandomForestClassifier      128.91            1.00           0.87
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{c+c1}{\PYZsh{} plot the combined ROC curves}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{randomforest}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{red}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandomForest (area = }\PY{l+s+si}{\PYZpc{}0.2f}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{auc\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yellow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KNN (area = }\PY{l+s+si}{\PYZpc{}0.2f}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{auc\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{logit}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{green}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LogisticRegression (area = }\PY{l+s+si}{\PYZpc{}0.2f}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{auc\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
         \PY{n}{y\PYZus{}pred} \PY{o}{=} \PY{n}{svc}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{thresholds} \PY{o}{=} \PY{n}{roc\PYZus{}curve}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{fpr}\PY{p}{,} \PY{n}{tpr}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{magenta}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                 \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SVC (area = }\PY{l+s+si}{\PYZpc{}0.2f}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{n}{auc\PYZus{}list}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{navy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{lw}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{False Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{True Positive Rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{14}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Receiver Operating Characteristic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{17}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lower right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Step 9: Improving the
Model}\label{step-9-improving-the-model}

Now that we have some basic models on the board, we want to try to
improve these. Below, we list a few things to explore in this pursuit.

\begin{itemize}
\tightlist
\item
  More feature engineering and exploration. For example, should we keep
  the co related features? Why or why not?
\item
  Hyperparameter tuning and grid search. All of our models have
  additional hyperparameters to tune and explore. For example the number
  of neighbors in KNN or the maximum depth of a Decision Tree.\\
\item
  We will adjust our models performance metric as well.
\end{itemize}

    \textbf{Additional Steps for Improving the Model:} **

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Removing Class imbalance using SMOTE library

  \begin{enumerate}
  \def\labelenumii{\arabic{enumii}.}
  \setcounter{enumii}{1}
  \tightlist
  \item
    Hyparameter tuning using GridSearch

    \begin{enumerate}
    \def\labelenumiii{\arabic{enumiii}.}
    \setcounter{enumiii}{2}
    \tightlist
    \item
      Additional Feature engineering by removing features based on
      feature importance

      **
    \end{enumerate}
  \end{enumerate}
\end{enumerate}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{k+kn}{from} \PY{n+nn}{imblearn}\PY{n+nn}{.}\PY{n+nn}{over\PYZus{}sampling} \PY{k}{import} \PY{n}{SMOTE}
         \PY{k+kn}{from} \PY{n+nn}{imblearn}\PY{n+nn}{.}\PY{n+nn}{under\PYZus{}sampling} \PY{k}{import} \PY{n}{RandomUnderSampler}
         \PY{k+kn}{from} \PY{n+nn}{imblearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{Pipeline}
         \PY{k+kn}{from} \PY{n+nn}{imblearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{make\PYZus{}pipeline}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{c+c1}{\PYZsh{}Use SMOTE to correct class imbalance }
         
         \PY{c+c1}{\PYZsh{} creating an instance}
         \PY{n}{sm} \PY{o}{=} \PY{n}{SMOTE}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{27}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} applying it to the training set}
         
         \PY{n}{X\PYZus{}train\PYZus{}smote}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}smote} \PY{o}{=} \PY{n}{sm}\PY{o}{.}\PY{n}{fit\PYZus{}resample}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{n}{y\PYZus{}train\PYZus{}smote}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}71}]:} -1    9667
          1    9667
         Name: Label, dtype: int64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{k}{def} \PY{n+nf}{class\PYZus{}balanced}\PY{p}{(}\PY{n}{hexcolorA}\PY{p}{,} \PY{n}{hexcolorB}\PY{p}{,} \PY{n}{edgecolor}\PY{p}{)}\PY{p}{:}
             
                
             \PY{n}{fig}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{)}
         
             \PY{n}{target\PYZus{}cnt} \PY{o}{=} \PY{n}{y\PYZus{}train\PYZus{}smote}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}index}\PY{p}{(}\PY{p}{)}
         
             \PY{n}{ax}\PY{o}{.}\PY{n}{bar}\PY{p}{(}\PY{n}{target\PYZus{}cnt}\PY{o}{.}\PY{n}{index}\PY{p}{,} \PY{n}{target\PYZus{}cnt}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{p}{[}\PY{n}{hexcolorA} \PY{k}{if} \PY{n}{i}\PY{o}{\PYZpc{}}\PY{k}{2}==0 else hexcolorB for i in range(9)],
                \PY{n}{width}\PY{o}{=}\PY{l+m+mf}{0.30}\PY{p}{,} 
                \PY{n}{edgecolor}\PY{o}{=}\PY{n}{edgecolor}\PY{p}{,} 
                \PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         
             \PY{n}{ax}\PY{o}{.}\PY{n}{margins}\PY{p}{(}\PY{l+m+mf}{0.02}\PY{p}{,} \PY{l+m+mf}{0.05}\PY{p}{)}
         
                
             \PY{c+c1}{\PYZsh{}for i in range(2):}
             \PY{c+c1}{\PYZsh{}ax.annotate(f\PYZsq{}\PYZob{}target\PYZus{}cnt[i]/len(df)*100:.3\PYZcb{}\PYZsq{}, xy=(i, target\PYZus{}cnt[i]+1000),}
                            \PY{c+c1}{\PYZsh{}va=\PYZsq{}center\PYZsq{}, ha=\PYZsq{}center\PYZsq{},)}
             
             \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Target Variable Distribution}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{weight}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bold}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{15}\PY{p}{)}
             \PY{n}{ax}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{y}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{alpha}\PY{o}{=}\PY{l+m+mf}{0.4}\PY{p}{)}
         
             \PY{n}{fig}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
             \PY{k}{return}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{c+c1}{\PYZsh{} Recheck inbalance after applying the smote library}
         \PY{n}{class\PYZus{}balanced}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}FFDDF4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{}AFEEEE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_90_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \textbf{We can compare the output of cell 33 to that of cell 142 and see
that smote resample method was able to balance the classes properly}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{n}{X\PYZus{}train\PYZus{}smote}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}74}]:}        Hour and Minutes  Hour  Minutes  Seconds  Number of announcements  \textbackslash{}
         0                  1027    10       27        1                      100   
         1                  1902    19        2       16                       36   
         2                   216     2       16       10                      139   
         3                   805     8        5       12                       26   
         4                  1726    17       26        2                      117   
         {\ldots}                 {\ldots}   {\ldots}      {\ldots}      {\ldots}                      {\ldots}   
         19329              1350    13       50        1                      140   
         19330              1304    13        4        0                      122   
         19331              2213    22       13        2                      168   
         19332              1714    17       14        0                      417   
         19333               442     4       42        4                       84   
         
                Number of withdrawals  Number of announced NLRI prefixes  \textbackslash{}
         0                          7                                233   
         1                          5                                 67   
         2                          4                                467   
         3                          2                                 36   
         4                          8                                212   
         {\ldots}                      {\ldots}                                {\ldots}   
         19329                      7                                366   
         19330                      7                                256   
         19331                      6                                525   
         19332                      9                               1298   
         19333                      5                                164   
         
                Number of withdrawn NLRI prefixes  Average AS-path length  \textbackslash{}
         0                                     35                       6   
         1                                     33                       6   
         2                                     21                       6   
         3                                      7                       6   
         4                                     59                       7   
         {\ldots}                                  {\ldots}                     {\ldots}   
         19329                                105                       6   
         19330                                 81                       6   
         19331                                 34                       5   
         19332                                106                       6   
         19333                                 27                       6   
         
                Maximum AS-path length  {\ldots}  Maximum AS-path length10  \textbackslash{}
         0                          15  {\ldots}                         0   
         1                           9  {\ldots}                         0   
         2                          13  {\ldots}                         0   
         3                           9  {\ldots}                         0   
         4                          13  {\ldots}                         0   
         {\ldots}                       {\ldots}  {\ldots}                       {\ldots}   
         19329                      14  {\ldots}                         0   
         19330                      12  {\ldots}                         0   
         19331                      12  {\ldots}                         0   
         19332                      13  {\ldots}                         0   
         19333                      16  {\ldots}                         0   
         
                Maximum AS-path length11  Maximum AS-path length12  \textbackslash{}
         0                             0                         0   
         1                             0                         0   
         2                             0                         1   
         3                             0                         0   
         4                             0                         1   
         {\ldots}                         {\ldots}                       {\ldots}   
         19329                         0                         0   
         19330                         0                         0   
         19331                         1                         0   
         19332                         0                         0   
         19333                         0                         0   
         
                Maximum AS-path length13  Maximum AS-path length14  \textbackslash{}
         0                             0                         1   
         1                             0                         0   
         2                             0                         0   
         3                             0                         0   
         4                             0                         0   
         {\ldots}                         {\ldots}                       {\ldots}   
         19329                         1                         0   
         19330                         0                         0   
         19331                         0                         0   
         19332                         0                         0   
         19333                         0                         0   
         
                Maximum AS-path length15  \textbackslash{}
         0                             0   
         1                             0   
         2                             0   
         3                             0   
         4                             0   
         {\ldots}                         {\ldots}   
         19329                         0   
         19330                         0   
         19331                         0   
         19332                         0   
         19333                         0   
         
                Number of Interior Gateway Protocol (IGP) packets  \textbackslash{}
         0                                                     93   
         1                                                     31   
         2                                                    135   
         3                                                     22   
         4                                                    100   
         {\ldots}                                                  {\ldots}   
         19329                                                118   
         19330                                                109   
         19331                                                160   
         19332                                                388   
         19333                                                 78   
         
                Number of Exterior Gateway Protocol (EGP) packets  \textbackslash{}
         0                                                      0   
         1                                                      0   
         2                                                      0   
         3                                                      0   
         4                                                      0   
         {\ldots}                                                  {\ldots}   
         19329                                                  0   
         19330                                                  0   
         19331                                                  0   
         19332                                                  0   
         19333                                                  0   
         
                Number of incomplete packets  Packet size (B)  
         0                                 7              252  
         1                                 5              237  
         2                                 4              278  
         3                                 4              214  
         4                                17              245  
         {\ldots}                             {\ldots}              {\ldots}  
         19329                            22              268  
         19330                            13              253  
         19331                             7              267  
         19332                            29              274  
         19333                             6              246  
         
         [19334 rows x 41 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{n+nb}{list}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}smote}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}75}]:} ['Hour and Minutes',
          'Hour',
          'Minutes',
          'Seconds',
          'Number of announcements',
          'Number of withdrawals',
          'Number of announced NLRI prefixes',
          'Number of withdrawn NLRI prefixes',
          'Average AS-path length',
          'Maximum AS-path length',
          'Average unique AS-path length',
          'Number of duplicate announcements',
          'Number of duplicate withdrawals',
          'Number of implicit withdrawals',
          'Average edit distance',
          'Maximum edit distance',
          'Inter-arrival time',
          'Maximum edit distance7',
          'Maximum edit distance8',
          'Maximum edit distance9',
          'Maximum edit distance10',
          'Maximum edit distance11',
          'Maximum edit distance12',
          'Maximum edit distance13',
          'Maximum edit distance14',
          'Maximum edit distance15',
          'Maximum edit distance16',
          'Maximum edit distance17',
          'Maximum AS-path length7',
          'Maximum AS-path length8',
          'Maximum AS-path length9',
          'Maximum AS-path length10',
          'Maximum AS-path length11',
          'Maximum AS-path length12',
          'Maximum AS-path length13',
          'Maximum AS-path length14',
          'Maximum AS-path length15',
          'Number of Interior Gateway Protocol (IGP) packets',
          'Number of Exterior Gateway Protocol (EGP) packets',
          'Number of incomplete packets',
          'Packet size (B)']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{c+c1}{\PYZsh{} 1 MLM Logistic Regression}
         \PY{n}{logmodel2} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{solver}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{liblinear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{logmodel2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}smote}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}smote}\PY{p}{)}
         \PY{n}{prediction\PYZus{}1} \PY{o}{=} \PY{n}{logmodel2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Score report}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{prediction\PYZus{}1}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

          -1       0.86      0.93      0.89      3215
           1       0.73      0.57      0.64      1097

    accuracy                           0.84      4312
   macro avg       0.79      0.75      0.76      4312
weighted avg       0.83      0.84      0.83      4312


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{c+c1}{\PYZsh{} 2 MLM Decision tree}
         \PY{n}{clf} \PY{o}{=} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{150}\PY{p}{)}
         \PY{n}{clf}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}smote}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}smote}\PY{p}{)}
         \PY{n}{prediction\PYZus{}2} \PY{o}{=} \PY{n}{clf}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Score report}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{prediction\PYZus{}2}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

          -1       0.91      0.91      0.91      3215
           1       0.74      0.74      0.74      1097

    accuracy                           0.87      4312
   macro avg       0.83      0.83      0.83      4312
weighted avg       0.87      0.87      0.87      4312


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{c+c1}{\PYZsh{} 3 MLM KNN}
         \PY{n}{knn} \PY{o}{=} \PY{n}{KNeighborsClassifier}\PY{p}{(}\PY{n}{n\PYZus{}neighbors} \PY{o}{=} \PY{l+m+mi}{100}\PY{p}{)}
         \PY{n}{knn}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}smote}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}smote}\PY{p}{)}
         \PY{n}{prediction\PYZus{}3} \PY{o}{=} \PY{n}{knn}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Score report}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{prediction\PYZus{}3}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

          -1       0.95      0.71      0.81      3215
           1       0.51      0.88      0.65      1097

    accuracy                           0.76      4312
   macro avg       0.73      0.80      0.73      4312
weighted avg       0.84      0.76      0.77      4312


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{c+c1}{\PYZsh{} 4 MLM SVM}
         \PY{n}{svm2}\PY{o}{=}\PY{n}{svm}\PY{o}{.}\PY{n}{SVC}\PY{p}{(}\PY{n}{kernel}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{poly}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{degree}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{probability}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{svm2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train\PYZus{}smote}\PY{p}{,}\PY{n}{y\PYZus{}train\PYZus{}smote}\PY{p}{)}
         \PY{n}{prediction\PYZus{}4} \PY{o}{=} \PY{n}{svm2}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} Score report}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{prediction\PYZus{}4}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

          -1       0.89      0.89      0.89      3215
           1       0.67      0.67      0.67      1097

    accuracy                           0.83      4312
   macro avg       0.78      0.78      0.78      4312
weighted avg       0.83      0.83      0.83      4312


    \end{Verbatim}

    \textbf{Applying HalvingGridSearchCV for best parameter selection}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{k}{def} \PY{n+nf}{create\PYZus{}pipe}\PY{p}{(}\PY{n}{clf}\PY{p}{)}\PY{p}{:}
         
             \PY{n}{pipeline} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{over}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{SMOTE}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                  \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{under}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{RandomUnderSampler}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                  \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{clf}\PY{p}{)}\PY{p}{]}\PY{p}{)}
             \PY{k}{return} \PY{n}{pipeline}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{n}{models} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RandForest}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{n}{RandomForestClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}\PY{p}{,}
                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LogReg}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}\PY{p}{,}
                   \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{knn}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{KNeighborsClassifier}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{svm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{SVC}\PY{p}{(}\PY{p}{)}
                   \PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{k}{for} \PY{n}{name}\PY{p}{,} \PY{n}{model}\PY{p}{,} \PY{o+ow}{in} \PY{n}{models}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{clf} \PY{o}{=} \PY{n}{model}
             \PY{n}{pipeline} \PY{o}{=} \PY{n}{create\PYZus{}pipe}\PY{p}{(}\PY{n}{clf}\PY{p}{)}
             \PY{n}{scores} \PY{o}{=} \PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{(}\PY{n}{pipeline}\PY{p}{,} \PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f1\PYZus{}macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{error\PYZus{}score}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{raise}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{name}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{: Mean f1 Macro: }\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{ and Standard Deviation: (}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{)}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{scores}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{scores}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
RandForest : Mean f1 Macro: 0.824 and Standard Deviation: (0.003)
LogReg : Mean f1 Macro: 0.770 and Standard Deviation: (0.006)
knn : Mean f1 Macro: 0.746 and Standard Deviation: (0.004)
svm : Mean f1 Macro: 0.781 and Standard Deviation: (0.001)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{parameters} \PY{o}{=} \PY{p}{[}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clf\PYZus{}\PYZus{}solver}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{newton\PYZhy{}cg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lbfgs}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{liblinear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,}
                        \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clf\PYZus{}\PYZus{}C}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{]}\PY{p}{\PYZcb{}}\PY{p}{]}
         
         \PY{n}{clf} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{,} \PY{n}{max\PYZus{}iter}\PY{o}{=}\PY{l+m+mi}{500}\PY{p}{)}
         \PY{n}{pipeline} \PY{o}{=} \PY{n}{create\PYZus{}pipe}\PY{p}{(}\PY{n}{clf}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{n}{pipeline}\PY{o}{.}\PY{n}{get\PYZus{}params}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}84}]:} \{'memory': None,
          'steps': [('over', SMOTE(random\_state=42)),
           ('under', RandomUnderSampler(random\_state=42)),
           ('clf', LogisticRegression(max\_iter=500, random\_state=42))],
          'verbose': False,
          'over': SMOTE(random\_state=42),
          'under': RandomUnderSampler(random\_state=42),
          'clf': LogisticRegression(max\_iter=500, random\_state=42),
          'over\_\_k\_neighbors': 5,
          'over\_\_n\_jobs': None,
          'over\_\_random\_state': 42,
          'over\_\_sampling\_strategy': 'auto',
          'under\_\_random\_state': 42,
          'under\_\_replacement': False,
          'under\_\_sampling\_strategy': 'auto',
          'clf\_\_C': 1.0,
          'clf\_\_class\_weight': None,
          'clf\_\_dual': False,
          'clf\_\_fit\_intercept': True,
          'clf\_\_intercept\_scaling': 1,
          'clf\_\_l1\_ratio': None,
          'clf\_\_max\_iter': 500,
          'clf\_\_multi\_class': 'auto',
          'clf\_\_n\_jobs': None,
          'clf\_\_penalty': 'l2',
          'clf\_\_random\_state': 42,
          'clf\_\_solver': 'lbfgs',
          'clf\_\_tol': 0.0001,
          'clf\_\_verbose': 0,
          'clf\_\_warm\_start': False\}
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{grid} \PY{o}{=} \PY{n}{HalvingGridSearchCV}\PY{p}{(}\PY{n}{pipeline}\PY{p}{,} 
                                    \PY{n}{parameters}\PY{p}{,} 
                                    \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f1\PYZus{}macro}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                    \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
         
         
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Best cross\PYZhy{}validation accuracy: }\PY{l+s+si}{\PYZob{}:.3f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{grid}\PY{o}{.}\PY{n}{best\PYZus{}score\PYZus{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test set score: }\PY{l+s+si}{\PYZob{}:.3f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{grid}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}\PY{p}{)} 
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Best parameters: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{grid}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Best cross-validation accuracy: 0.777
Test set score: 0.778
Best parameters: \{'clf\_\_C': 0.1, 'clf\_\_solver': 'newton-cg'\}

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{c+c1}{\PYZsh{} defining parameter range}
         \PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{1000}\PY{p}{]}\PY{p}{,} 
                       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gamma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.001}\PY{p}{,} \PY{l+m+mf}{0.0001}\PY{p}{]}\PY{p}{,}
                       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kernel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{\PYZcb{}} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{c+c1}{\PYZsh{} instantiate the halving grid}
         \PY{n}{halving\PYZus{}grid\PYZus{}svc}\PY{o}{=}\PY{n}{HalvingGridSearchCV}\PY{p}{(}\PY{n}{SVC}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{refit} \PY{o}{=} \PY{k+kc}{True}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{n\PYZus{}jobs} \PY{o}{=} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} fit the grid with data}
         \PY{n}{halving\PYZus{}grid\PYZus{}svc}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
n\_iterations: 3
n\_required\_iterations: 3
n\_possible\_iterations: 3
min\_resources\_: 1437
max\_resources\_: 12935
aggressive\_elimination: False
factor: 3
----------
iter: 0
n\_candidates: 25
n\_resources: 1437
Fitting 10 folds for each of 25 candidates, totalling 250 fits
----------
iter: 1
n\_candidates: 9
n\_resources: 4311
Fitting 10 folds for each of 9 candidates, totalling 90 fits
----------
iter: 2
n\_candidates: 3
n\_resources: 12933
Fitting 10 folds for each of 3 candidates, totalling 30 fits

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}87}]:} HalvingGridSearchCV(cv=10, estimator=SVC(), n\_jobs=-1,
                             param\_grid=\{'C': [0.1, 1, 10, 100, 1000],
                                         'gamma': [1, 0.1, 0.01, 0.001, 0.0001],
                                         'kernel': ['rbf']\},
                             refit=<function \_refit\_callable at 0x0000020904FABC80>,
                             verbose=3)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Best cross\PYZhy{}validation accuracy: }\PY{l+s+si}{\PYZob{}:.3f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{halving\PYZus{}grid\PYZus{}svc}\PY{o}{.}\PY{n}{best\PYZus{}score\PYZus{}}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Test set score: }\PY{l+s+si}{\PYZob{}:.3f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{halving\PYZus{}grid\PYZus{}svc}\PY{o}{.}\PY{n}{score}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}\PY{p}{)}\PY{p}{)} 
         \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Best parameters: }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{halving\PYZus{}grid\PYZus{}svc}\PY{o}{.}\PY{n}{best\PYZus{}params\PYZus{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Best cross-validation accuracy: 0.852
Test set score: 0.850
Best parameters: \{'C': 1, 'gamma': 0.0001, 'kernel': 'rbf'\}

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{n}{y\PYZus{}pred\PYZus{}SVC} \PY{o}{=} \PY{n}{halving\PYZus{}grid\PYZus{}svc}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
         
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}pred\PYZus{}SVC}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
0.849721706864564

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{c+c1}{\PYZsh{} Score report}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{classification\PYZus{}report}\PY{p}{(}\PY{n}{y\PYZus{}test}\PY{p}{,}\PY{n}{y\PYZus{}pred\PYZus{}SVC}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
              precision    recall  f1-score   support

          -1       0.88      0.92      0.90      3215
           1       0.74      0.63      0.68      1097

    accuracy                           0.85      4312
   macro avg       0.81      0.78      0.79      4312
weighted avg       0.84      0.85      0.85      4312


    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{c+c1}{\PYZsh{} Plot}
         \PY{n}{plot\PYZus{}1} \PY{o}{=} \PY{n}{plot\PYZus{}confusion\PYZus{}matrix}\PY{p}{(}\PY{n}{halving\PYZus{}grid\PYZus{}svc}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{display\PYZus{}labels}\PY{o}{=}\PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZhy{}1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{1}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}\PY{p}{,}\PY{n}{cmap} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{Reds}\PY{p}{,}\PY{n}{values\PYZus{}format} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.2f}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plot\PYZus{}1}\PY{o}{.}\PY{n}{figure\PYZus{}}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Confusion Matrix}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_110_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \textbf{Best SVC based Model based on HalvingGridSearch results:}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}92}]:} \PY{c+c1}{\PYZsh{}setup a pipeline based on GridSearch suggested results}
         \PY{n}{optimum\PYZus{}svc\PYZus{}model} \PY{o}{=} \PY{n}{SVC}\PY{p}{(}\PY{n}{C}\PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{degree}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{,} \PY{n}{gamma}\PY{o}{=} \PY{l+m+mf}{0.0001}\PY{p}{,} \PY{n}{kernel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rbf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{optimum\PYZus{}pipeline} \PY{o}{=} \PY{n}{Pipeline}\PY{p}{(}\PY{p}{[}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{over}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{SMOTE}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                  \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{under}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{RandomUnderSampler}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{)}\PY{p}{)}\PY{p}{,}
                                  \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{clf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{optimum\PYZus{}svc\PYZus{}model}\PY{p}{)}\PY{p}{]}\PY{p}{)}
         \PY{n}{optimum\PYZus{}pipeline}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train}\PY{p}{)}
         \PY{n}{optimum\PYZus{}results} \PY{o}{=} \PY{n}{optimum\PYZus{}pipeline}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}test}\PY{p}{)}
          
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{n}{col\PYZus{}names} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
         \PY{n}{feature\PYZus{}names} \PY{o}{=} \PY{n}{col\PYZus{}names}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{n}{perm\PYZus{}importance} \PY{o}{=} \PY{n}{permutation\PYZus{}importance}\PY{p}{(}\PY{n}{optimum\PYZus{}pipeline}\PY{p}{,} \PY{n}{X\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{)}
         \PY{n}{features} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{array}\PY{p}{(}\PY{n}{feature\PYZus{}names}\PY{p}{)}
         
         \PY{n}{sorted\PYZus{}idx} \PY{o}{=} \PY{n}{perm\PYZus{}importance}\PY{o}{.}\PY{n}{importances\PYZus{}mean}\PY{o}{.}\PY{n}{argsort}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{barh}\PY{p}{(}\PY{n}{features}\PY{p}{[}\PY{n}{sorted\PYZus{}idx}\PY{p}{]}\PY{p}{,} \PY{n}{perm\PYZus{}importance}\PY{o}{.}\PY{n}{importances\PYZus{}mean}\PY{p}{[}\PY{n}{sorted\PYZus{}idx}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Permutation Importance}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}94}]:} Text(0.5, 0, 'Permutation Importance')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_114_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}95}]:} \PY{n}{features}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}95}]:} array(['Hour and Minutes', 'Hour', 'Minutes', 'Seconds',
                'Number of announcements', 'Number of withdrawals',
                'Number of announced NLRI prefixes',
                'Number of withdrawn NLRI prefixes', 'Average AS-path length',
                'Maximum AS-path length', 'Average unique AS-path length',
                'Number of duplicate announcements',
                'Number of duplicate withdrawals',
                'Number of implicit withdrawals', 'Average edit distance',
                'Maximum edit distance', 'Inter-arrival time',
                'Maximum edit distance7', 'Maximum edit distance8',
                'Maximum edit distance9', 'Maximum edit distance10',
                'Maximum edit distance11', 'Maximum edit distance12',
                'Maximum edit distance13', 'Maximum edit distance14',
                'Maximum edit distance15', 'Maximum edit distance16',
                'Maximum edit distance17', 'Maximum AS-path length7',
                'Maximum AS-path length8', 'Maximum AS-path length9',
                'Maximum AS-path length10', 'Maximum AS-path length11',
                'Maximum AS-path length12', 'Maximum AS-path length13',
                'Maximum AS-path length14', 'Maximum AS-path length15',
                'Number of Interior Gateway Protocol (IGP) packets',
                'Number of Exterior Gateway Protocol (EGP) packets',
                'Number of incomplete packets', 'Packet size (B)'], dtype='<U49')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}96}]:} \PY{n}{draw\PYZus{}roc}\PY{p}{(}\PY{n}{y\PYZus{}train}\PY{p}{,} \PY{n}{y\PYZus{}train\PYZus{}pred\PYZus{}prob}\PY{p}{,} \PY{n}{y\PYZus{}test}\PY{p}{,} \PY{n}{y\PYZus{}test\PYZus{}pred\PYZus{}prob}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_116_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Step 10: Generate Predictions for new data based on our
best
model}\label{step-10-generate-predictions-for-new-data-based-on-our-best-model}

    \textbf{Function to view the prediction from the optimized model from
GridSearch}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}97}]:}  \PY{k}{def} \PY{n+nf}{Grid\PYZus{}Optimized\PYZus{}Prediction}\PY{p}{(}\PY{n}{bgpupdate}\PY{p}{)}\PY{p}{:}    
            
              \PY{n}{bgp}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{bgpupdate}\PY{p}{)}
             
              \PY{n}{results} \PY{o}{=} \PY{n}{optimum\PYZus{}pipeline}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{bgp}\PY{p}{)}
             
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{The predicted bgp update status is: \PYZdl{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{results}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Here is how to interpret the results:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{An outcome of  }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{1}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ indicates that there is an Anomaly in this BGP Update}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
              \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{An outcome of }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{\PYZhy{}1}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ indicates that the BGP Update is normal}\PY{l+s+s2}{\PYZdq{}} \PY{p}{)}
              \PY{k}{return}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}98}]:} \PY{n}{df}\PY{o}{.}\PY{n}{tail}\PY{p}{(}\PY{l+m+mi}{15}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}98}]:}        Hour and Minutes  Hour  Minutes  Seconds  Number of announcements  \textbackslash{}
         17232              2345    23       45        5                       41   
         17233              2346    23       46        2                       82   
         17234              2347    23       47       12                       21   
         17235              2348    23       48        5                       78   
         17236              2349    23       49        5                       59   
         17237              2350    23       50        6                       44   
         17238              2351    23       51        1                       42   
         17239              2352    23       52        4                       29   
         17240              2353    23       53        1                       59   
         17241              2354    23       54       14                       41   
         17242              2355    23       55       12                       41   
         17243              2356    23       56        5                       31   
         17244              2357    23       57        0                       44   
         17245              2358    23       58        4                       65   
         17246              2359    23       59       14                       57   
         
                Number of withdrawals  Number of announced NLRI prefixes  \textbackslash{}
         17232                      3                                 96   
         17233                      4                                197   
         17234                      5                                 32   
         17235                      7                                227   
         17236                      6                                131   
         17237                      5                                 91   
         17238                      5                                 63   
         17239                      4                                 40   
         17240                      4                                 99   
         17241                      4                                 56   
         17242                      5                                202   
         17243                      3                                286   
         17244                      6                                 96   
         17245                      4                                170   
         17246                      6                                 89   
         
                Number of withdrawn NLRI prefixes  Average AS-path length  \textbackslash{}
         17232                                 14                       5   
         17233                                  9                       6   
         17234                                 10                       5   
         17235                                 29                       7   
         17236                                 58                       6   
         17237                                 19                       7   
         17238                                 21                       6   
         17239                                  8                       6   
         17240                                 15                       7   
         17241                                 11                       6   
         17242                                 31                       5   
         17243                                  5                       6   
         17244                                 42                       6   
         17245                                 24                       6   
         17246                                 24                       6   
         
                Maximum AS-path length  {\ldots}  Maximum AS-path length11  \textbackslash{}
         17232                      11  {\ldots}                         0   
         17233                      11  {\ldots}                         0   
         17234                       7  {\ldots}                         0   
         17235                      15  {\ldots}                         0   
         17236                      13  {\ldots}                         0   
         17237                      14  {\ldots}                         0   
         17238                      14  {\ldots}                         0   
         17239                      10  {\ldots}                         0   
         17240                      14  {\ldots}                         0   
         17241                      12  {\ldots}                         1   
         17242                      10  {\ldots}                         0   
         17243                       7  {\ldots}                         0   
         17244                       8  {\ldots}                         0   
         17245                       9  {\ldots}                         0   
         17246                       9  {\ldots}                         0   
         
                Maximum AS-path length12  Maximum AS-path length13  \textbackslash{}
         17232                         0                         0   
         17233                         0                         0   
         17234                         0                         0   
         17235                         0                         0   
         17236                         1                         0   
         17237                         0                         1   
         17238                         0                         1   
         17239                         0                         0   
         17240                         0                         1   
         17241                         0                         0   
         17242                         0                         0   
         17243                         0                         0   
         17244                         0                         0   
         17245                         0                         0   
         17246                         0                         0   
         
                Maximum AS-path length14  Maximum AS-path length15  \textbackslash{}
         17232                         0                         0   
         17233                         0                         0   
         17234                         0                         0   
         17235                         1                         0   
         17236                         0                         0   
         17237                         0                         0   
         17238                         0                         0   
         17239                         0                         0   
         17240                         0                         0   
         17241                         0                         0   
         17242                         0                         0   
         17243                         0                         0   
         17244                         0                         0   
         17245                         0                         0   
         17246                         0                         0   
         
                Number of Interior Gateway Protocol (IGP) packets  \textbackslash{}
         17232                                                 37   
         17233                                                 74   
         17234                                                 21   
         17235                                                 72   
         17236                                                 55   
         17237                                                 37   
         17238                                                 38   
         17239                                                 29   
         17240                                                 53   
         17241                                                 38   
         17242                                                 40   
         17243                                                 31   
         17244                                                 41   
         17245                                                 58   
         17246                                                 54   
         
                Number of Exterior Gateway Protocol (EGP) packets  \textbackslash{}
         17232                                                  0   
         17233                                                  0   
         17234                                                  0   
         17235                                                  0   
         17236                                                  0   
         17237                                                  0   
         17238                                                  0   
         17239                                                  0   
         17240                                                  0   
         17241                                                  0   
         17242                                                  0   
         17243                                                  0   
         17244                                                  0   
         17245                                                  0   
         17246                                                  0   
         
                Number of incomplete packets  Packet size (B)  Label  
         17232                             4              243     -1  
         17233                             8              248     -1  
         17234                             0              207     -1  
         17235                             6              263     -1  
         17236                             4              255     -1  
         17237                             7              239     -1  
         17238                             4              222     -1  
         17239                             0              214     -1  
         17240                             6              230     -1  
         17241                             3              218     -1  
         17242                             1              303     -1  
         17243                             0              348     -1  
         17244                             3              247     -1  
         17245                             7              255     -1  
         17246                             3              223     -1  
         
         [15 rows x 42 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{c+c1}{\PYZsh{}This is going to be our random record for predictions}
         \PY{n}{df}\PY{p}{[}\PY{l+m+mi}{17237}\PY{p}{:}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}99}]:}        Hour and Minutes  Hour  Minutes  Seconds  Number of announcements  \textbackslash{}
         17237              2350    23       50        6                       44   
         17238              2351    23       51        1                       42   
         17239              2352    23       52        4                       29   
         17240              2353    23       53        1                       59   
         17241              2354    23       54       14                       41   
         17242              2355    23       55       12                       41   
         17243              2356    23       56        5                       31   
         17244              2357    23       57        0                       44   
         17245              2358    23       58        4                       65   
         17246              2359    23       59       14                       57   
         
                Number of withdrawals  Number of announced NLRI prefixes  \textbackslash{}
         17237                      5                                 91   
         17238                      5                                 63   
         17239                      4                                 40   
         17240                      4                                 99   
         17241                      4                                 56   
         17242                      5                                202   
         17243                      3                                286   
         17244                      6                                 96   
         17245                      4                                170   
         17246                      6                                 89   
         
                Number of withdrawn NLRI prefixes  Average AS-path length  \textbackslash{}
         17237                                 19                       7   
         17238                                 21                       6   
         17239                                  8                       6   
         17240                                 15                       7   
         17241                                 11                       6   
         17242                                 31                       5   
         17243                                  5                       6   
         17244                                 42                       6   
         17245                                 24                       6   
         17246                                 24                       6   
         
                Maximum AS-path length  {\ldots}  Maximum AS-path length11  \textbackslash{}
         17237                      14  {\ldots}                         0   
         17238                      14  {\ldots}                         0   
         17239                      10  {\ldots}                         0   
         17240                      14  {\ldots}                         0   
         17241                      12  {\ldots}                         1   
         17242                      10  {\ldots}                         0   
         17243                       7  {\ldots}                         0   
         17244                       8  {\ldots}                         0   
         17245                       9  {\ldots}                         0   
         17246                       9  {\ldots}                         0   
         
                Maximum AS-path length12  Maximum AS-path length13  \textbackslash{}
         17237                         0                         1   
         17238                         0                         1   
         17239                         0                         0   
         17240                         0                         1   
         17241                         0                         0   
         17242                         0                         0   
         17243                         0                         0   
         17244                         0                         0   
         17245                         0                         0   
         17246                         0                         0   
         
                Maximum AS-path length14  Maximum AS-path length15  \textbackslash{}
         17237                         0                         0   
         17238                         0                         0   
         17239                         0                         0   
         17240                         0                         0   
         17241                         0                         0   
         17242                         0                         0   
         17243                         0                         0   
         17244                         0                         0   
         17245                         0                         0   
         17246                         0                         0   
         
                Number of Interior Gateway Protocol (IGP) packets  \textbackslash{}
         17237                                                 37   
         17238                                                 38   
         17239                                                 29   
         17240                                                 53   
         17241                                                 38   
         17242                                                 40   
         17243                                                 31   
         17244                                                 41   
         17245                                                 58   
         17246                                                 54   
         
                Number of Exterior Gateway Protocol (EGP) packets  \textbackslash{}
         17237                                                  0   
         17238                                                  0   
         17239                                                  0   
         17240                                                  0   
         17241                                                  0   
         17242                                                  0   
         17243                                                  0   
         17244                                                  0   
         17245                                                  0   
         17246                                                  0   
         
                Number of incomplete packets  Packet size (B)  Label  
         17237                             7              239     -1  
         17238                             4              222     -1  
         17239                             0              214     -1  
         17240                             6              230     -1  
         17241                             3              218     -1  
         17242                             1              303     -1  
         17243                             0              348     -1  
         17244                             3              247     -1  
         17245                             7              255     -1  
         17246                             3              223     -1  
         
         [10 rows x 42 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}100}]:} \PY{n}{newbgpupdate}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+m+mi}{17237}\PY{p}{:}\PY{p}{]}
          \PY{n}{newbgpupdate}\PY{o}{=} \PY{n}{newbgpupdate}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}101}]:} \PY{n}{Grid\PYZus{}Optimized\PYZus{}Prediction}\PY{p}{(}\PY{n}{newbgpupdate}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The predicted bgp update status is: \$ [-1 -1 -1 -1 -1 -1 -1 -1  1 -1]

Here is how to interpret the results:

An outcome of  '1' indicates that there is an Anomaly in this BGP Update

An outcome of '-1' indicates that the BGP Update is normal

    \end{Verbatim}

    \subsubsection{Result Summary:}\label{result-summary}

\begin{quote}
\textbf{We can see that the latest model based on GridSearchCV is pretty
accurate. It got one prediction wrong which is in line with the accuracy
rate on test data and ROC characterestics}
\end{quote}

\textbf{Findings and Actionable Insights:} \textgreater{} 1. The
objective of this capstone project was to come up with an optimum
classification model to predict whether a bgp update message can be
classified as anomalous or normal based on the update message
attributes. 2. I analyzed 37 numerical variables which capture the
various attributed of a typical BGP protocol update to build the model.
3. Exploratory data analysis showed absence of null values in the
dataset, and the data is imbalanced, where ``1'' anomalous message is
the majority class. 4. Univariate analysis revealed that
Average\_AS\_Path length and Number of Implicit withdrawals does not
help very much when it comes to predicting the target variable. Some
numerical features tend to predict the target variable much better (for
example: {[}'Maximum AS-path length', 'Number of duplicate
announcements', 'Maximum edit distance', 'Number of Exterior Gateway
Protocol (EGP) packets'{]} etc.) 5. Dataset preprocessing of numerical
data was done using standscaler and MinMax scaler 6. Basic models were
built using K Nearest Neighbor, Logistic Regression, Decision Trees, and
Support Vector Machines. 7. The most important features in predicting
whether a BGP update is anomalous based on the Support Vector model
was\\
{[}'Hour and Minutes', 'Hour', 'Minutes', 'Seconds', 'Number of
announcements', 'Number of withdrawals', 'Number of announced NLRI
prefixes', 'Number of withdrawn NLRI prefixes', 'Average AS-path
length', 'Maximum AS-path length', 'Average unique AS-path length',
'Number of duplicate announcements', 'Number of duplicate withdrawals',
'Number of implicit withdrawals'{]} 8. GridSearch and Halving GridSearch
was used to find the best parameters. The best parameters derived from
Gridsearch were as follows: \{'C': 1, 'gamma': 0.0001, 'kernel':
'rbf'\}. SMOTE library was used to remedy the class imbalance. 9. Radial
Basis Kernel function was used to find a non-linear classifier, C was
set to 1 to control error based on the RIPE dataset, to minimize the
cost function. Gamma was set to a low value to figure out the optimum
curvature in the decision boundary. 10. Support Vector model gave the
best performance with Halving GridSearchCV and the best test AUC was
0.86 which was similar to the results reported by researchers at CAIDA,
RIPE, and Simon Fraser University in previous research reports.

    \subsubsection{Next Steps in the Classifier Model
Enhancement:}\label{next-steps-in-the-classifier-model-enhancement}

\begin{quote}
\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Fine Tuning the model based on domain knowledge and feature importance
  results
\item
  We could reduce the dimensions/features further to tune the model.
\item
  Support Vector Model training even with HalvingGridSearch was very
  slow.
\item
  There are some new libraries like T-POT
  https://epistasislab.github.io/tpot/using/ that use genetic algorithms
  for hyperparameter tuning to derive the best pipeline for this
  classification problem. For best feature selection we could use a
  library like YellowBrick
  https://www.scikit-yb.org/en/latest/api/model\_selection/importances.html
\item
  Ensemble models, XGBoost could be used as next step in improving the
  performance of the current SVM model
\item
  Neural Networks/Autoencoders and LSTM based model seems to be well
  suited for this class of problems.
\end{enumerate}
\end{quote}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
